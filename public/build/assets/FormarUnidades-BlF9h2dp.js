import{C as g,D as m,c as _,a as j,o as O,w as f,b as i,d as H,t as x,u as y}from"./app-D3MqHhzN.js";import"./buttons.print-C_oaZFPC.js";import"./jspdf.plugin.autotable-BhKR-0jB.js";import{_ as R}from"./DirectivoLayout-DtrRXceR.js";const L={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},$={class:"overflow-x-auto relative"},T={class:"text-sm leading-normal border-b border-gray-300"},A={class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"2"},N={__name:"FormarUnidades",props:{message:{String,default:""},color:{String,default:""},ruta:{type:Object},unidades:{type:Object},unidadesConOperador:{type:Object},operador:{type:Object},directivo:{type:Object},rolServicio:{type:Object},castigo:{type:Object},entrada:{type:Object},corte:{type:Object},ultimaCorrida:{type:Object},tipoUltimaCorrida:{type:Object},usuario:{type:Object}},setup(h){g.use(m),g.use(m);const n=h,p=`${n.usuario.apellidoP} ${n.usuario.apellidoM} ${n.usuario.nombre}`;function U(d){const o=new Date(d),l=new Date(o.setDate(o.getDate()-o.getDay()+1)),s=new Date(o.getFullYear(),0,1),r=Math.floor((l-s)/(24*60*60*1e3));return Math.ceil((r+s.getDay()+1)/7)}const u=new Date().toLocaleDateString(),w=D(new Date().getDay()),v=U(new Date)+1;function D(d){return["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"][d]}const S=[{data:"idUnidad",render:(d,o,l,s)=>{const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;return e&&e.nombre_completo===p&&r.ruta?r.ruta.nombreRuta:""}else return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;if(e&&e.nombre_completo===p){const t=n.rolServicio.filter(a=>a.idUnidad===r.idUnidad);return t.length>0?(t.sort((a,c)=>new Date(c.created_at)-new Date(a.created_at)),t[0].trabajaDomingo):'<span style="color: red;">Sin asignar</span>'}else return""}else return"Unidad no encontrada"}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;return e&&e.nombre_completo===p?r.numeroUnidad:""}else return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.directivo.find(t=>t.idDirectivo===r.idDirectivo);return e?e.nombre_completo===p?e.nombre_completo:"":e?e.nombre_completo:""}else return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;if(e&&e.nombre_completo===p){const t=n.entrada.filter(a=>a.idUnidad===r.idUnidad&&new Date(a.created_at).toLocaleDateString()===u);if(t.length>0)return t.map(c=>c.horaEntrada.substring(0,5)).join(", ")}}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;if(e&&e.nombre_completo===p){const t=n.entrada.filter(a=>a.idUnidad===r.idUnidad&&new Date(a.created_at).toLocaleDateString()===u);if(t.length>0)return t.map(c=>c.tipoEntrada).join(", ")}}return""}},{data:"idUnidad",className:"text-center",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;if(e&&e.nombre_completo===p){const t=n.entrada.filter(a=>a.idUnidad===r.idUnidad&&new Date(a.created_at).toLocaleDateString()===u);if(t.length>0)return t.map(c=>c.extremo).join(", ")}}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0)return e.map((a,c)=>`
            <div style="${e.length>1&&c!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${a.horaCorte.substring(0,5)}</div>
            </div>
          `).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0)return e.map((a,c)=>`
            <div style="${e.length>1&&c!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${a.causa}</div>
            </div>
          `).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0)return e.map((a,c)=>{const b=a.horaRegreso?a.horaRegreso.substring(0,5):"";return`
            <div style="${e.length>1&&c!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${b}</div>
            </div>
          `}).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0){const t=n.tipoUltimaCorrida.find(a=>a.idTipoUltimaCorrida===e[0].idTipoUltimaCorrida);if(t)return t.tipoUltimaCorrida}}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0){const t=e[0].horaInicioUC;return t?t.substring(0,5):""}}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=n.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===u);if(e.length>0){const t=e[0].horaFinUC;if(t)return t.substring(0,5)}}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.castigo.filter(e=>e.idUnidad===d&&new Date(e.created_at).toLocaleDateString()===u);if(r.length>0){const e=r.map(t=>({horaInicio:t.horaInicio?t.horaInicio.substring(0,5):""}));return e.map((t,a)=>`
          <div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
            <div>${t.horaInicio}</div>
          </div>
        `).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.castigo.filter(e=>e.idUnidad===d&&new Date(e.created_at).toLocaleDateString()===u);if(r.length>0){const e=r.map(t=>({horaFin:t.horaFin?t.horaFin.substring(0,5):""}));return e.map((t,a)=>`
          <div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
            <div>${t.horaFin}</div>
          </div>
        `).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.castigo.filter(e=>e.idUnidad===d&&new Date(e.created_at).toLocaleDateString()===u);if(r.length>0){const e=r.map(t=>t.castigo||"");return e.map((t,a)=>`<div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">${t}</div>`).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.castigo.filter(e=>e.idUnidad===d&&new Date(e.created_at).toLocaleDateString()===u);if(r.length>0){const e=r.map(t=>t.observaciones||"");return e.map((t,a)=>`<div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">${t}</div>`).join("")}return""}},{data:"idUnidad",render:function(d,o,l,s){const r=n.unidades.find(e=>e.idUnidad===d);if(r){const e=r.directivo;if(e&&e.nombre_completo===p){const t=n.operador.find(a=>a.idOperador===r.idOperador);return t?t.nombre_completo:'<span style="color: red;">Sin asignar</span>'}else return""}else return""}}],C=_(()=>n.unidades.filter(o=>o.directivo.nombre_completo===p));return(d,o)=>(O(),j(R,{title:"Formar Unidades",usuario:n.usuario},{default:f(()=>[i("div",L,[o[8]||(o[8]=i("h2",{class:"font-bold text-center text-xl pt-0"}," Formación de Unidades",-1)),o[9]||(o[9]=i("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-1.5"},null,-1)),i("div",$,[H(y(g),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"formacionTablaId",name:"formacionTablaId",columns:S,data:C.value,options:{responsive:!1,autoWidth:!1,language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)"},paging:!1,lengthMenu:[]}},{default:f(()=>[i("thead",null,[i("tr",T,[i("th",A,"FECHA: "+x(y(w)+", "+y(u))+" -- SEMANA: "+x(v),1),o[0]||(o[0]=i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1)),o[1]||(o[1]=i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1)),o[2]||(o[2]=i("th",{class:"py-2 px-4 bg-green-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300 text-left",colspan:"3"},"ENTRADA",-1)),o[3]||(o[3]=i("th",{class:"py-2 px-4 bg-red-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"3"},"CORTE",-1)),o[4]||(o[4]=i("th",{class:"py-2 px-4 bg-blue-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"3"},"ÚLTIMAS CORRIDAS",-1)),o[5]||(o[5]=i("th",{class:"py-2 px-4 bg-yellow-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"4"},"CASTIGO",-1)),o[6]||(o[6]=i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1))]),o[7]||(o[7]=i("tr",{class:"text-sm leading-normal border-b border-gray-300"},[i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Ruta "),i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Trab. DOMINGO "),i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Unidad "),i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Socio / Prestador "),i("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. entrada "),i("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Tipo entrada "),i("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Extremo "),i("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. Corte "),i("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Causa "),i("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. regreso "),i("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Tipo de Corrida "),i("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. inicio "),i("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. regreso "),i("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. inicio "),i("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. finaliza "),i("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Motivo "),i("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Otras observaciones "),i("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Operador ")],-1))])]),_:1},8,["data"])])])]),_:1},8,["usuario"]))}};export{N as default};
