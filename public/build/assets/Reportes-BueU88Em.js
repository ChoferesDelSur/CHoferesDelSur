import{_ as K,a as G,b as Y,c as J,d as q,e as H,f as I,g as Q}from"./ReportesUltimasCorridas-CO1_NGP3.js";import{_ as W}from"./ServicioLayout-DmtcbJ_8.js";import{r as U,J as X,o as u,h as f,y as _,b as d,t as h,j as N,z as A,u as R,K as Z,F as v,i as ee,n as E,k as z,G as P,a as ae,w as oe,d as c}from"./app-BhdhTycl.js";import{S as w}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as x,w as B}from"./xlsx-DjuO7_Ju.js";import{E as M}from"./jspdf.plugin.autotable-dd-b4oLh.js";/* empty css                                                               */const re={class:"text-lg font-bold"},te={class:"flex flex-wrap gap-4 mb-3"},ne={class:"flex flex-wrap space-x-3 mb-2"},de=["onUpdate:modelValue"],se=["value"],ie={class:"flex flex-wrap space-x-3"},ce=["onClick"],F=2024,le={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(L){const a=U([]),$=X({unidad:null,operador:null}),l=async n=>{const o=route("reporte.opSinTrabajar",{semana:n});try{const e=await P.get(o);a.value=Object.values(e.data)}catch(e){console.error("Error al obtener los datos:",e.response?e.response.data:e.message),w.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},O=async(n,o,e,r)=>{if(console.log("Semana seleccionada:",t),!t){w.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await l(t),n.titulo==="Operadores Sin Trabajar"&&(o==="pdf"?g(n.titulo,t):o==="excel"&&k(n.titulo,t))}catch{w.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},g=(n,o)=>{const e=new M("portrait");e.setFontSize(12),e.text(`Reporte de ${n} - Semana ${o}`,14,20),e.setFontSize(10),e.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const r=[{header:"Nombre del operador",dataKey:"nombre"}],i=a.value.map(b=>({nombre:b.nombre_completo||"N/A"}));e.autoTable({columns:r,body:i,startY:24,styles:{fontSize:10}});const p=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});e.setFontSize(10),e.text(`Fecha de creación: ${p}`,14,e.internal.pageSize.height-10);const m=`${n}-Semana-${o}.pdf`;e.save(m)},k=(n,o)=>{const e=`${n}-Semana-${o}.xlsx`,r=[["Nombre del Operador"]];a.value.forEach(m=>{const b=m.nombre_completo||"N/A";r.push([b])});const i=x.book_new(),p=x.aoa_to_sheet(r);x.book_append_sheet(i,p,"Operadores_Sin_Trabajar"),B(i,e)},S=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],y=Array.from({length:52},(n,o)=>o+1),T=new Date().getFullYear();Array.from({length:T-F+1},(n,o)=>F+o);let t=1;const s=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(n,o)=>(u(),f(v,null,_(s,e=>d("div",{key:e.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[d("h3",re,h(e.titulo),1),o[3]||(o[3]=d("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),d("div",te,[d("div",ne,[o[2]||(o[2]=d("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1)),N(d("select",{"onUpdate:modelValue":r=>e.periodoSeleccionado=r,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},o[1]||(o[1]=[d("option",{value:"semana"},"Semanal",-1)]),8,de),[[A,e.periodoSeleccionado]]),e.periodoSeleccionado==="semana"?N((u(),f("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=r=>Z(t)?t.value=r:t=r),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(u(!0),f(v,null,_(R(y),(r,i)=>(u(),f("option",{key:i,value:r},"Semana "+h(r),9,se))),128))],512)),[[A,R(t)]]):ee("",!0)])]),d("div",ie,[(u(),f(v,null,_(S,r=>d("button",{key:r.tipo,class:E(r.clase),onClick:i=>O(e,r.tipo,$.operador,{tipo:e.periodoSeleccionado,valor:e.periodoSeleccionado==="semana"?R(t):""})},[d("i",{class:E(r.icono+" mr-2 jump-icon")},null,2),z(" "+h(r.texto),1)],10,ce)),64))])])),64))}},ue={class:"text-lg font-bold"},pe={class:"flex flex-wrap space-x-3"},me=["onClick"],be={__name:"ReportesMultasDominicales",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})}},setup(L){const a=U([]),$=()=>{const t=new Date,s=t.getDay(),n=s===0?0:s,o=new Date(t);return o.setDate(t.getDate()-n),o.toLocaleDateString()},l=[{titulo:"Multas Dominicales"}],O=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],g=t=>{if(!t)return"Sin registro";const[s,n]=t.split(":");return`${s}:${n}`},k=async(t,s)=>{console.log("Estoy en generar Archivo:");const n=$(),o=`${t.titulo} - ${n}`;try{const e=await P.get(route("reporte.multasDominicales"));a.value=e.data,console.log("Datos obtenidos de la consulta:",a.value),s==="pdf"?y(o):s==="excel"&&T(o)}catch(e){console.error(e),w.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},S=t=>t?`${t.nombre} ${t.apellidoP} ${t.apellidoM}`:"Sin registro",y=t=>{const s=new M("landscape");s.setFontSize(12),s.text(`Reporte de ${t}`,14,20);const n=a.value.map(e=>{const r=e.numeroUnidad||"N/A",i=e.directivo?`${e.directivo.nombre_completo}`:"N/A",p=e.entradaSabado?g(e.entradaSabado.horaEntrada):"Sin registro",m=e.entradaSabado?S(e.entradaSabado.operador):"Sin registro",b=e.entradaSabado&&e.entradaSabado.ruta?e.entradaSabado.ruta.nombreRuta:"Sin registro",j=e.entradaLunesTemprana?g(e.entradaLunesTemprana.horaEntrada):"Sin registro",D=e.entradaLunesTemprana?S(e.entradaLunesTemprana.operador):"Sin registro",C=e.entradaLunesTemprana&&e.entradaLunesTemprana.ruta?e.entradaLunesTemprana.ruta.nombreRuta:"Sin registro";return[r,i,p,m,b,j,D,C]}),o=[["Numero Unidad","Socio/Prestador","Sábado (horaEntrada)","Operador (Sábado)","Ruta (Sábado)","Lunes (horaEntrada)","Operador (Lunes)","Ruta (Lunes)"]];s.autoTable({head:o,body:n,startY:24}),s.save(`${t}.pdf`)},T=t=>{const s=`${t}.xlsx`,n=[["Numero Unidad","Socio/Prestador","Sábado (horaEntrada)","Operador (Sábado)","Ruta (Sábado)","Lunes (horaEntrada)","Operador (Lunes)","Ruta (Lunes)","Justificado"]];a.value.forEach(r=>{const i=r.numeroUnidad||"N/A",p=r.directivo?`${r.directivo.nombre_completo}`:"N/A",m=r.entradaSabado?g(r.entradaSabado.horaEntrada):"Sin registro",b=r.entradaSabado?S(r.entradaSabado.operador):"Sin registro",j=r.entradaSabado&&r.entradaSabado.ruta?r.entradaSabado.ruta.nombreRuta:"Sin registro",D=r.entradaLunesTemprana?g(r.entradaLunesTemprana.horaEntrada):"Sin registro",C=r.entradaLunesTemprana?S(r.entradaLunesTemprana.operador):"Sin registro",V=r.entradaLunesTemprana&&r.entradaLunesTemprana.ruta?r.entradaLunesTemprana.ruta.nombreRuta:"Sin registro";n.push([i,p,m,b,j,D,C,V,""])});const o=x.book_new(),e=x.aoa_to_sheet(n);x.book_append_sheet(o,e,"Reporte_Multas"),B(o,s)};return(t,s)=>(u(),f(v,null,_(l,n=>d("div",{key:n.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[d("h3",ue,h(n.titulo),1),s[0]||(s[0]=d("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),d("div",pe,[(u(),f(v,null,_(O,o=>d("button",{key:o.tipo,class:E(o.clase),onClick:e=>k(n,o.tipo)},[d("i",{class:E(o.icono+" mr-2 jump-icon")},null,2),z(" "+h(o.texto),1)],10,me)),64))])])),64))}},fe={class:"mt-1 bg-white p-4 shadow rounded-lg h-5/6"},we={__name:"Reportes",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},tipoUltimaCorrida:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})},ultimaCorrida:{type:Object,default:()=>({})},castigo:{type:Object,default:()=>({})}},setup(L){const a=L;return($,l)=>(u(),ae(W,{title:"Reportes",usuario:a.usuario},{default:oe(()=>[d("div",fe,[l[0]||(l[0]=d("h2",{class:"font-bold text-center text-xl pt-0 mb-2"},"Reportes",-1)),l[1]||(l[1]=d("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-2"},null,-1)),c(K,{unidad:a.unidad,operador:a.operador,entrada:a.entrada},null,8,["unidad","operador","entrada"]),c(G,{unidad:a.unidad,operador:a.operador,entrada:a.entrada},null,8,["unidad","operador","entrada"]),c(Y,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),c(J,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),c(q,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),c(H,{unidad:a.unidad,operador:a.operador,tipoUltimaCorrida:a.tipoUltimaCorrida,ultimaCorrida:a.ultimaCorrida},null,8,["unidad","operador","tipoUltimaCorrida","ultimaCorrida"]),c(I,{unidad:a.unidad,operador:a.operador,castigo:a.castigo},null,8,["unidad","operador","castigo"]),c(Q,{unidad:a.unidad,operador:a.operador},null,8,["unidad","operador"]),c(le,{unidad:a.unidad,operador:a.operador},null,8,["unidad","operador"]),c(be,{unidad:a.unidad,entrada:a.entrada,corte:a.corte},null,8,["unidad","entrada","corte"])])]),_:1},8,["usuario"]))}};export{we as default};
