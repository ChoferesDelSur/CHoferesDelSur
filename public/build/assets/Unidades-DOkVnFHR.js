import{e as V,x as z,r as O,o as b,a as q,w as M,b as e,g as H,t as h,k as v,j as E,u as n,v as Q,h as y,i as j,F as A,y as T,z as N,c as ee,d as I,G as ae,C as Y,D as te,f as ne,A as de}from"./app-DKY7pHet.js";import"./buttons.print-cnAWLXhX.js";import{S as J}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{_ as le}from"./Mensaje-DAM774KY.js";import{_ as ue}from"./ServicioLayout-BJOJnH6y.js";import{_ as X}from"./Modal-BynIwB2A.js";/* empty css                   */import{E as ce}from"./jspdf.plugin.autotable-CneeF7WA.js";import{u as K,w as me}from"./xlsx-DjuO7_Ju.js";/* empty css                                                */const pe={class:"mt-2 bg-white p-4 shadow rounded-lg"},ge={class:"border-b border-gray-900/10 pb-12"},be={class:"text-base font-semibold leading-7 text-gray-900"},fe={class:"flex flex-wrap -mx-4"},xe={class:"sm:col-span-2"},ve={class:"sm:col-span-1",hidden:""},ye={class:"mt-2"},he=["id"],Ue={class:"sm:col-span-2 px-4"},we={class:"mt-2"},Se=["id"],$e={key:0,class:"text-red-500 text-xs mt-1"},Oe={class:"sm:col-span-2 px-4"},De={class:"mt-2"},ke=["id"],_e=["value"],Ee={key:0,class:"text-red-500 text-xs mt-1"},Ce={class:"sm:col-span-2 px-4"},je={class:"mt-2"},Re=["id"],Be=["value"],Ie={class:"sm:col-span-2 px-4"},Ae={class:"mt-2"},Te=["id"],Ne=["value"],Me={key:0,class:"text-red-500 text-xs mt-1"},Fe={class:"mt-6 flex items-center justify-end gap-x-6"},Le=["id"],We=["disabled"],ze={__name:"FormularioUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:s}){const m=o,C=s,d=V({idUnidad:m.unidad.idUnidad,numeroUnidad:m.unidad.numeroUnidad,ruta:m.unidad.idRuta,operador:m.unidad.idOperador,directivo:m.directivo.idDirectivo});z(()=>m.unidad,async l=>{d.idUnidad=l.idUnidad,d.numeroUnidad=l.numeroUnidad,d.ruta=l.idRuta,d.operador=l.idOperador,d.directivo=l.idDirectivo},{deep:!0});const u=O(""),c=O("");O("");const x=O(""),w=async()=>{C("close"),d.reset()},k=l=>typeof l=="string"&&l.trim()!=="",_=l=>l!=null,g=async()=>{u.value=k(d.numeroUnidad)?"":"Ingrese el número de la unidad",c.value=_(d.ruta)?"":"Selecciones la ruta",x.value=_(d.directivo)?"":"Seleccione el dueño de la unidad",!(u.value||c.value||x.value)&&d.post(route("servicio.addUnidad"),{onSuccess:()=>{w(),u.value="",c.value="",x.value=""}})};return(l,a)=>(b(),q(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:w},{default:M(()=>[e("div",pe,[e("form",{onSubmit:H(g,["prevent"])},[e("div",ge,[e("h2",be,h(o.title),1),a[13]||(a[13]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},[v("Rellene el formulario para poder registrar una unidad. Los campos con "),e("span",{class:"text-red-500"},"*"),v(" son obligatorios ")],-1)),e("div",fe,[e("div",xe,[e("div",ve,[a[5]||(a[5]=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1)),e("div",ye,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":a[0]||(a[0]=t=>n(d).idUnidad=t),placeholder:"Ingrese id de la unidad",id:"idUnidad"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,he),[[Q,n(d).idUnidad]])])])]),e("div",Ue,[a[6]||(a[6]=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1)),e("div",we,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+o.op,"onUpdate:modelValue":a[1]||(a[1]=t=>n(d).numeroUnidad=t),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Se),[[Q,n(d).numeroUnidad]])]),u.value!=""?(b(),y("div",$e,h(u.value),1)):j("",!0)]),e("div",Oe,[a[8]||(a[8]=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Ruta "),e("span",{class:"text-red-500"},"*")],-1)),e("div",De,[E(e("select",{name:"ruta",id:"ruta"+o.op,"onUpdate:modelValue":a[2]||(a[2]=t=>n(d).ruta=t),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[a[7]||(a[7]=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1)),(b(!0),y(A,null,T(o.ruta,t=>(b(),y("option",{key:t.idRuta,value:t.idRuta},h(t.nombreRuta),9,_e))),128))],8,ke),[[N,n(d).ruta]])]),c.value!=""?(b(),y("div",Ee,h(c.value),1)):j("",!0)]),e("div",Ce,[a[10]||(a[10]=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1)),e("div",je,[E(e("select",{name:"operador",id:"operador"+o.op,"onUpdate:modelValue":a[3]||(a[3]=t=>n(d).operador=t),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[a[9]||(a[9]=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1)),(b(!0),y(A,null,T(o.operadoresDisp,t=>(b(),y("option",{key:t.idOperador,value:t.idOperador},h(t.nombre_completo),9,Be))),128))],8,Re),[[N,n(d).operador]])])]),e("div",Ie,[a[12]||(a[12]=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ae,[E(e("select",{name:"directivo",id:"directivo"+o.op,"onUpdate:modelValue":a[4]||(a[4]=t=>n(d).directivo=t),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[a[11]||(a[11]=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1)),(b(!0),y(A,null,T(o.directivo,t=>(b(),y("option",{key:t.idDirectivo,value:t.idDirectivo},h(t.nombre_completo),9,Ne))),128))],8,Te),[[N,n(d).directivo]])]),x.value!=""?(b(),y("div",Me,h(x.value),1)):j("",!0)])])]),e("div",Fe,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:w},a[14]||(a[14]=[e("i",{class:"fa-solid fa-ban"},null,-1),v(" Cancelar")]),8,Le),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(d).processing},a[15]||(a[15]=[e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),v("Guardar")]),8,We)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Ve={class:"mt-2 bg-white p-4 shadow rounded-lg"},qe={class:"border-b border-gray-900/10 pb-12"},Pe={class:"text-base font-semibold leading-7 text-gray-900"},Ge={class:"flex flex-wrap -mx-4"},Qe={class:"sm:col-span-2"},He={class:"sm:col-span-1",hidden:""},Xe={class:"mt-2"},Ye=["id"],Je={class:"sm:col-span-2 px-4"},Ke={class:"mt-2"},Ze=["id"],et={key:0,class:"text-red-500 text-xs mt-1"},tt={class:"sm:col-span-2 px-4"},dt={class:"mt-2"},at=["id"],ot=["value"],it={key:0,class:"text-red-500 text-xs mt-1"},st={class:"sm:col-span-2 px-4"},rt={class:"mt-2"},nt={class:"block rounded-md py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 sm:text-sm sm:leading-6"},lt={class:"sm:col-span-2 px-4"},ut={class:"mt-2"},ct=["id"],mt=["value"],pt={key:0,class:"text-red-500 text-xs mt-1"},gt={class:"mt-6 flex items-center justify-end gap-x-6"},bt=["id"],ft=["disabled"],xt={__name:"FormularioActualizarUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:s}){const m=o,C=s,d=V({_method:"PUT",idUnidad:m.unidad.idUnidad,numeroUnidad:m.unidad.numeroUnidad,ruta:m.unidad.idRuta,operador:m.unidad.idOperador,directivo:m.unidad.idDirectivo});z(()=>m.unidad,async a=>{d.idUnidad=a.idUnidad,d.numeroUnidad=a.numeroUnidad,d.ruta=a.idRuta,d.operador=a.idOperador,d.directivo=a.idDirectivo},{deep:!0});const u=O(""),c=O("");O("");const x=O(""),w=async()=>{C("close"),d.reset()},k=a=>typeof a=="string"&&a.trim()!=="",_=a=>a!=null,g=async()=>{if(u.value=k(d.numeroUnidad)?"":"Ingrese el número de la unidad",c.value=_(d.ruta)?"":"Selecciones la ruta",x.value=_(d.directivo)?"":"Seleccione el dueño de la unidad",!(u.value||c.value||x.value)){var a=document.getElementById("idUnidad2").value;d.post(route("servicio.actualizarUnidad",a),{onSuccess:()=>{w(),u.value="",c.value="",x.value=""}})}},l=a=>{const t=m.operador.find(r=>r.idOperador===a);return t?t.nombre_completo:"Operador no encontrado"};return(a,t)=>(b(),q(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:w},{default:M(()=>[e("div",Ve,[e("form",{onSubmit:H(g,["prevent"])},[e("div",qe,[e("h2",Pe,h(o.title),1),t[11]||(t[11]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Modifique los datos según sea necesario y guarde los cambios. ",-1)),e("div",Ge,[e("div",Qe,[e("div",He,[t[4]||(t[4]=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1)),e("div",Xe,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":t[0]||(t[0]=r=>n(d).idUnidad=r),placeholder:"Ingrese id de la unidad",id:"idUnidad"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Ye),[[Q,n(d).idUnidad]])])])]),e("div",Je,[t[5]||(t[5]=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ke,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+o.op,"onUpdate:modelValue":t[1]||(t[1]=r=>n(d).numeroUnidad=r),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Ze),[[Q,n(d).numeroUnidad]])]),u.value!=""?(b(),y("div",et,h(u.value),1)):j("",!0)]),e("div",tt,[t[7]||(t[7]=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Ruta "),e("span",{class:"text-red-500"},"*")],-1)),e("div",dt,[E(e("select",{name:"ruta",id:"ruta"+o.op,"onUpdate:modelValue":t[2]||(t[2]=r=>n(d).ruta=r),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[6]||(t[6]=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1)),(b(!0),y(A,null,T(o.ruta,r=>(b(),y("option",{key:r.idRuta,value:r.idRuta},h(r.nombreRuta),9,ot))),128))],8,at),[[N,n(d).ruta]])]),c.value!=""?(b(),y("div",it,h(c.value),1)):j("",!0)]),e("div",st,[t[8]||(t[8]=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1)),e("div",rt,[e("p",nt,h(l(n(d).operador)),1)])]),e("div",lt,[t[10]||(t[10]=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ut,[E(e("select",{name:"directivo",id:"directivo"+o.op,"onUpdate:modelValue":t[3]||(t[3]=r=>n(d).directivo=r),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[9]||(t[9]=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1)),(b(!0),y(A,null,T(o.directivo,r=>(b(),y("option",{key:r.idDirectivo,value:r.idDirectivo},h(r.nombre_completo),9,mt))),128))],8,ct),[[N,n(d).directivo]])]),x.value!=""?(b(),y("div",pt,h(x.value),1)):j("",!0)])])]),e("div",gt,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:w},t[12]||(t[12]=[e("i",{class:"fa-solid fa-ban"},null,-1),v(" Cancelar")]),8,bt),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(d).processing},t[13]||(t[13]=[e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),v("Guardar")]),8,ft)])],32)])]),_:1},8,["show","max-width","closeable"]))}},vt={class:"mt-2 bg-white p-4 shadow rounded-lg"},yt={class:"border-b border-gray-900/10 pb-12"},ht={class:"text-base font-semibold leading-7 text-gray-900"},Ut={class:"flex flex-wrap -mx-4"},wt={class:"sm:col-span-2 w-56 px-4"},St={class:"mt-2"},$t={key:0,class:"text-red-500 text-xs mt-1"},Ot={class:"sm:col-span-2 px-4"},Dt={class:"mt-2"},kt=["id"],_t=["value"],Et={key:0,class:"text-red-500 text-xs mt-1"},Ct={class:"mt-6 flex items-center justify-end gap-x-6"},jt=["id"],Rt=["disabled"],Bt={__name:"FormularioAsignarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesDisp:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:s}){const m=o,C=s,d=V({idUnidad:m.unidad.idUnidad,unidad:m.unidad.idUnidad,operador:m.unidad.idOperador});z(()=>m.unidad,async a=>{d.idUnidad=a.idUnidad,d.unidad=a.idUnidad,d.operador=a.idOperador},{deep:!0});const u=O(""),c=O(""),x=ee(()=>{const a=m.unidadesDisp.find(t=>t.idUnidad===d.unidad);return a?a.idDirectivo:null}),w=ee(()=>{const a=x.value;return a?m.operadoresDisp.filter(t=>t.idDirectivo===a).sort((t,r)=>t.nombre_completo.localeCompare(r.nombre_completo)):[]});z(()=>d.unidad,a=>{d.operador="",c.value=""},{deep:!0});const k=async()=>{C("close"),d.reset()},_=a=>a!=null,g=async()=>{u.value=_(d.unidad)?"":"Seleccione la unidad",c.value=_(d.operador)?"":"Seleccione el operador",!(u.value||c.value)&&d.post(route("servicio.asignarOperador"),{onSuccess:()=>{k(),u.value="",c.value=""}})},l=async()=>{if(numeroUnidadError.value=_(d.unidad)?"":"Seleccione la unidad",c.value=_(d.operador)?"":"Seleccione el operador",!(u.value||c.value)){var a=document.getElementById("idUnidad2").value;d.put(route("principal.actualizarUnidad",a),{onSuccess:()=>{k(),u.value="",c.value=""}})}};return(a,t)=>(b(),q(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:k},{default:M(()=>[e("div",vt,[e("form",{onSubmit:t[2]||(t[2]=H(r=>o.op==="1"?g():l(),["prevent"]))},[e("div",yt,[e("h2",ht,h(o.title),1),t[6]||(t[6]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Rellene el formulario para poder asignar un operador a una unidad. ",-1)),e("div",Ut,[e("div",wt,[t[3]||(t[3]=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Unidad "),e("span",{class:"text-red-500"},"*")],-1)),e("div",St,[I(n(ae),{modelValue:n(d).unidad,"onUpdate:modelValue":t[0]||(t[0]=r=>n(d).unidad=r),class:"w-full",options:o.unidadesDisp.map(r=>({label:r.numeroUnidad,value:r.idUnidad})),placeholder:"Seleccione la unidad",reduce:r=>r.value},null,8,["modelValue","options","reduce"])]),u.value!=""?(b(),y("div",$t,h(u.value),1)):j("",!0)]),e("div",Ot,[t[5]||(t[5]=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},[v("Operador "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Dt,[E(e("select",{name:"operador",id:"operador"+o.op,"onUpdate:modelValue":t[1]||(t[1]=r=>n(d).operador=r),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[4]||(t[4]=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1)),(b(!0),y(A,null,T(w.value,r=>(b(),y("option",{key:r.idOperador,value:r.idOperador},h(r.nombre_completo),9,_t))),128))],8,kt),[[N,n(d).operador]])]),c.value!=""?(b(),y("div",Et,h(c.value),1)):j("",!0)])])]),e("div",Ct,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:k},t[7]||(t[7]=[e("i",{class:"fa-solid fa-ban"},null,-1),v(" Cancelar")]),8,jt),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(d).processing},t[8]||(t[8]=[e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),v("Guardar")]),8,Rt)])],32)])]),_:1},8,["show","max-width","closeable"]))}},It={class:"mt-2 bg-white p-4 shadow rounded-lg"},At={class:"border-b border-gray-900/10 pb-12"},Tt={class:"text-base font-semibold leading-7 text-gray-900"},Nt={class:"sm:col-span-2 w-56 px-4"},Mt={class:"mt-2"},Ft={key:0,class:"text-red-500 text-xs mt-1"},Lt={class:"mt-6 flex items-center justify-end gap-x-6"},Wt=["id"],zt=["disabled"],Vt={__name:"FormularioQuitarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesConOperador:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:s}){const m=o,C=s,d=V({idUnidad:m.unidad.idUnidad,unidad:m.unidad.idUnidad,operador:m.unidad.idOperador});z(()=>m.unidad,async g=>{d.idUnidad=g.idUnidad,d.unidad=g.idUnidad,d.operador=g.idOperador},{deep:!0});const u=O(""),c=O(""),x=async()=>{C("close"),d.reset()},w=g=>g!=null,k=async()=>{u.value=w(d.unidad)?"":"Seleccione la unidad",!u.value&&d.post(route("servicio.quitarOperador"),{onSuccess:()=>{x(),u.value=""}})},_=async()=>{if(numeroUnidadError.value=w(d.unidad)?"":"Seleccione la unidad",c.value=w(d.operador)?"":"Seleccione el operador",!(u.value||c.value)){var g=document.getElementById("idUnidad2").value;console.log("idUnidad:"+g),d.put(route("servicio.actualizarUnidad",g),{onSuccess:()=>{x(),console.log("idUnidad Editando:"+g),u.value="",c.value=""}})}};return(g,l)=>(b(),q(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:x},{default:M(()=>[e("div",It,[e("form",{onSubmit:l[1]||(l[1]=H(a=>o.op==="1"?k():_(),["prevent"]))},[e("div",At,[e("h2",Tt,h(o.title),1),l[3]||(l[3]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Seleccione la unidad a la que le quiere quitar el operador. ",-1)),e("div",Nt,[l[2]||(l[2]=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},"Unidad",-1)),e("div",Mt,[I(n(ae),{modelValue:n(d).unidad,"onUpdate:modelValue":l[0]||(l[0]=a=>n(d).unidad=a),options:o.unidadesConOperador.map(a=>({label:a.numeroUnidad,value:a.idUnidad})),placeholder:"Seleccione la unidad",reduce:a=>a.value,class:"w-full"},null,8,["modelValue","options","reduce"])]),u.value!=""?(b(),y("div",Ft,h(u.value),1)):j("",!0)])]),e("div",Lt,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:x},l[4]||(l[4]=[e("i",{class:"fa-solid fa-ban"},null,-1),v(" Cancelar")]),8,Wt),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(d).processing},l[5]||(l[5]=[e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),v("Guardar")]),8,zt)])],32)])]),_:1},8,["show","max-width","closeable"]))}},qt={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},Pt={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},P="xl",G=!0,dd={__name:"Unidades",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object},ruta:{type:Object},operador:{type:Object},directivo:{type:Object},operadoresDisp:{type:Object},unidadesDisp:{type:Object},unidadesConOperador:{type:Object},usuario:{type:Object}},setup(o){Y.use(te),Y.use(te);const s=o,m=(p="Documento")=>{const i=new ce("landscape");i.setFontSize(12),i.text(p,14,22);const f=new Date().toLocaleDateString();i.setFontSize(8),i.text(`Fecha: ${f}`,260,22);const S=["ID","Número De Unidad","Operador","Ruta","Dueño De La Uniad"],U=[];de(()=>{$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().each(R=>{var L,B,Z;U.push([R.idUnidad,R.numeroUnidad,((L=s.operador.find(W=>W.idOperador===R.idOperador))==null?void 0:L.nombre_completo)||"",((B=s.ruta.find(W=>W.idRuta===R.idRuta))==null?void 0:B.nombreRuta)||"",((Z=s.directivo.find(W=>W.idDirectivo===R.idDirectivo))==null?void 0:Z.nombre_completo)||""])}),i.autoTable({head:[S],body:U,startY:24}),i.save(`${p}.pdf`)})},C=()=>{de(()=>{const f=$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().toArray().map(D=>{var F,R,L;return{ID:D.idUnidad,"Número De Unidad":D.numeroUnidad,Operador:((F=s.operador.find(B=>B.idOperador===D.idOperador))==null?void 0:F.nombre_completo)||"",Ruta:((R=s.ruta.find(B=>B.idRuta===D.idRuta))==null?void 0:R.nombreRuta)||"","Dueño De La Unidad":((L=s.directivo.find(B=>B.idDirectivo===D.idDirectivo))==null?void 0:L.nombre_completo)||""}}),S=K.json_to_sheet(f),U=K.book_new();K.book_append_sheet(U,S,"Operadores Registrados"),me(U,"Operadores Registrados.xlsx")})},d=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2]},button:!0},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>C()},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",orientation:"landscape",action:()=>m(s.title||"Unidades Registradas")},{title:"Unidades registradas",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[2,3,4,5,6]}}],u=[{data:null,render:function(p,i,f,S){return""}},{data:null,render:function(p,i,f,S){return`<input type="checkbox" class="unidades-checkboxes" data-id="${f.idUnidad}" ">`}},{data:null,render:function(p,i,f,S){return S.row+1}},{data:"numeroUnidad"},{data:"idOperador",render:function(p,i,f,S){if(p){const U=s.operador.find(D=>D.idOperador===p);return U?U.nombre_completo:""}else return'<span style="color: red;">Sin asignar</span>'}},{data:"idRuta",render:function(p,i,f,S){const U=s.ruta.find(D=>D.idRuta===p);return U?U.nombreRuta:""}},{data:"idDirectivo",render:function(p,i,f,S){const U=s.directivo.find(D=>D.idDirectivo===p);return U?U.nombre_completo:""}},{data:null,render:function(p,i,f,S){return`<button class="editar-button" data-id="${f.idUnidad}" style="display: flex; justify-content: center;"><i class="fa fa-pencil"></i></button>`}}],c=O(!1),x=O(!1),w=O(!1),k=O(!1),_=V({_method:"DELETE"}),g=O([]);var l={};const a=p=>{l=p,k.value=!0},t=()=>{c.value=!1},r=()=>{x.value=!1},oe=()=>{w.value=!1},ie=()=>{k.value=!1},se=p=>{g.value.includes(p)?g.value=g.value.filter(f=>f!==p):g.value.push(p);const i=document.getElementById("eliminarABtn");g.value.length>0?i.removeAttribute("disabled"):i.setAttribute("disabled","")};ne(()=>{document.getElementById("unidadesTablaId").addEventListener("click",p=>{const i=p.target;if(i.classList.contains("unidades-checkboxes")){const f=parseInt(i.getAttribute("data-id"));if(s.unidad){const S=s.unidad.find(U=>U.idUnidad===f);S?se(S):console.log("No se tiene unidad")}}}),$("#unidadesTablaId").on("click",".editar-button",function(){const p=$(this).data("id"),i=s.unidad.find(f=>f.idUnidad===p);a(i)})});const re=()=>{const p=J.mixin({buttonsStyling:!0}),i=g.value.map(f=>f.numeroUnidad).join(", ");p.fire({title:"¿Estas seguro que deseas eliminar la(s) unidad(es) seleccionada(s)?",html:`Unidades seleccionadas: ${i}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async f=>{if(f.isConfirmed)try{const U=g.value.map(F=>F.idUnidad).join(",");await _.post(route("servicio.eliminarUnidad",U)),g.value=[];const D=document.getElementById("eliminarABtn");g.value.length>0?D.removeAttribute("disabled"):D.setAttribute("disabled",""),J.fire({title:"Unidad(es) eliminado(s) correctamente",icon:"success"}),window.flash={message:"Unidad(es) eliminado(s) correctamente",color:"green"}}catch(S){console.log("Error al eliminar varias unidades: "+S),J.fire({title:"Error",text:"Hubo un error al eliminar las unidades. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(p,i)=>(b(),q(ue,{title:"Formar Unidades",usuario:s.usuario},{default:M(()=>[e("div",qt,[i[8]||(i[8]=e("h2",{class:"font-bold text-center text-xl pt-0"},"Unidades",-1)),i[9]||(i[9]=e("div",{class:"my-1"},null,-1)),i[10]||(i[10]=e("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1)),I(le),e("div",Pt,[e("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:i[0]||(i[0]=f=>c.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},i[3]||(i[3]=[e("i",{class:"fa fa-plus mr-2"},null,-1),v("Agregar Unidad ")])),e("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:re},i[4]||(i[4]=[e("i",{class:"fa fa-trash mr-2"},null,-1),v("Borrar Unidad ")])),e("button",{class:"bg-cyan-500 hover:bg-cyan-500 text-white font-semibold py-2 px-4 rounded",onClick:i[1]||(i[1]=f=>x.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},i[5]||(i[5]=[e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),v(" Asignar Operador ")])),e("button",{class:"bg-orange-500 hover:bg-orange-500 text-white font-semibold py-2 px-4 rounded",onClick:i[2]||(i[2]=f=>w.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},i[6]||(i[6]=[e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),v(" Quitar Operador ")]))]),e("div",null,[I(n(Y),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"unidadesTablaId",name:"unidadesTablaId",columns:u,data:o.unidad,options:{responsive:!0,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primero",previous:"Anterior",next:"Siguiente",last:"Ultimo"}},buttons:[d],pageLength:20}},{default:M(()=>i[7]||(i[7]=[e("thead",null,[e("tr",{class:"text-sm leading-normal"},[e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Número de Unidad "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Operador "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Ruta "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Dueño de la unidad ")])],-1)])),_:1},8,["data","options"])])]),I(ze,{show:c.value,"max-width":P,closeable:G,onClose:t,title:"Añadir unidad",op:"1",modal:"modalCreate",unidad:s.unidad,ruta:s.ruta,operadoresDisp:s.operadoresDisp,directivo:s.directivo},null,8,["show","unidad","ruta","operadoresDisp","directivo"]),I(xt,{show:k.value,"max-width":P,closeable:G,onClose:ie,title:"Editar unidad",op:"2",modal:"modalEdit",unidad:n(l),ruta:s.ruta,operador:s.operador,operadoresDisp:s.operadoresDisp,directivo:s.directivo},null,8,["show","unidad","ruta","operador","operadoresDisp","directivo"]),I(Bt,{show:x.value,"max-width":P,closeable:G,onClose:r,title:"Asignar operador",op:"1",modal:"modalCreate",unidad:s.unidad,unidadesDisp:s.unidadesDisp,operadoresDisp:s.operadoresDisp},null,8,["show","unidad","unidadesDisp","operadoresDisp"]),I(Vt,{show:w.value,"max-width":P,closeable:G,onClose:oe,title:"Quitar operador",op:"1",modal:"modalCreate",unidad:s.unidad,unidadesConOperador:s.unidadesConOperador,operadoresDisp:s.operadoresDisp},null,8,["show","unidad","unidadesConOperador","operadoresDisp"])]),_:1},8,["usuario"]))}};export{dd as default};
