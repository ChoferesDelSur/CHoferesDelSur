import{r as A,K as $,o as i,h as l,y as p,b as r,t as b,j as y,z as S,u as f,L as B,F as g,i as C,n as _,k as K,I as V}from"./app-CipHVF8A.js";import{S as x}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as h,w as L}from"./xlsx-DjuO7_Ju.js";import{E as P}from"./jspdf.plugin.autotable-CwwYqDD-.js";const Y={class:"text-lg font-bold"},R={class:"flex flex-wrap gap-4 mb-3"},U={class:"flex flex-wrap space-x-3 mb-2"},G=["onUpdate:modelValue"],q=["value"],I={class:"flex flex-wrap space-x-3"},M=["onClick"],v=2024,Z={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(H){const c=A([]),j=$({unidad:null,operador:null}),w=async t=>{const o=route("reporte.opSinTrabajar",{semana:t});try{const e=await V.get(o);c.value=Object.values(e.data),console.log(c.value)}catch(e){console.error("Error al obtener los datos:",e.response?e.response.data:e.message),x.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},k=async(t,o,e,a)=>{if(!n){x.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await w(n),t.titulo==="Operadores Sin Trabajar"&&(o==="pdf"?T(t.titulo,n):o==="excel"&&F(t.titulo,n))}catch{x.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},T=(t,o)=>{const e=new P("portrait");e.setFontSize(12),e.text(`Reporte de ${t} - Semana ${o}`,14,20),e.setFontSize(10),e.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const a=[{header:"Nombre del operador",dataKey:"nombre"},{header:"Última Día Trabajo",dataKey:"ultimaFechaTrabajo"}],s=c.value.map(m=>({nombre:m.nombre_completo||"N/A",ultimaFechaTrabajo:m.ultima_fecha_trabajo||"No ha trabajado"}));e.autoTable({columns:a,body:s,startY:40,styles:{fontSize:10}});const u=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});e.setFontSize(10),e.text(`Fecha de creación: ${u}`,14,e.internal.pageSize.height-10);const d=`${t}-Semana-${o}.pdf`;e.save(d)},F=(t,o)=>{const e=`${t}-Semana-${o}.xlsx`,a=[["Nombre del Operador","Último Día Trabajado"]];c.value.forEach(d=>{const m=d.nombre_completo||"N/A",z=d.ultimo_dia_trabajado||"No ha trabajado";a.push([m,z])});const s=h.book_new(),u=h.aoa_to_sheet(a);h.book_append_sheet(s,u,"Operadores_Sin_Trabajar"),L(s,e)},E=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],N=Array.from({length:52},(t,o)=>o+1),O=new Date().getFullYear();Array.from({length:O-v+1},(t,o)=>v+o);let n=1;const D=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(t,o)=>(i(),l(g,null,p(D,e=>r("div",{key:e.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[r("h3",Y,b(e.titulo),1),o[3]||(o[3]=r("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),r("div",R,[r("div",U,[o[2]||(o[2]=r("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1)),y(r("select",{"onUpdate:modelValue":a=>e.periodoSeleccionado=a,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},o[1]||(o[1]=[r("option",{value:"semana"},"Semanal",-1)]),8,G),[[S,e.periodoSeleccionado]]),e.periodoSeleccionado==="semana"?y((i(),l("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=a=>B(n)?n.value=a:n=a),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(i(!0),l(g,null,p(f(N),(a,s)=>(i(),l("option",{key:s,value:a},"Semana "+b(a),9,q))),128))],512)),[[S,f(n)]]):C("",!0)])]),r("div",I,[(i(),l(g,null,p(E,a=>r("button",{key:a.tipo,class:_(a.clase),onClick:s=>k(e,a.tipo,j.operador,{tipo:e.periodoSeleccionado,valor:e.periodoSeleccionado==="semana"?f(n):""})},[r("i",{class:_(a.icono+" mr-2 jump-icon")},null,2),K(" "+b(a.texto),1)],10,M)),64))])])),64))}};export{Z as _};
