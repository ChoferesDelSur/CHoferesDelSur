import{u as q,i as z,r as S,o as l,j as P,e as M,a as e,g as H,t as y,w as E,d as r,k as V,c as f,l as j,F as I,m as A,p as T,f as x,q as ee,L as Y,D as te,s as ne,b as N,x as de}from"./app-ywvr1C1W.js";import"./buttons.print-BwyIRfx8.js";import{S as J}from"./sweetalert2.all-Ghf09FYl.js";import{_ as re}from"./Mensaje-DTi04i2L.js";import{_ as le}from"./ServicioLayout-BXtpdecX.js";import{_ as X}from"./Modal-D3yVaLBs.js";import{E as ce}from"./jspdf.plugin.autotable-B2lAXuPa.js";import{u as K,w as ue}from"./xlsx-769MyM77.js";/* empty css                                                */const me={class:"mt-2 bg-white p-4 shadow rounded-lg"},pe={class:"border-b border-gray-900/10 pb-12"},ge={class:"text-base font-semibold leading-7 text-gray-900"},be=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},[x("Rellene el formulario para poder registrar una unidad. Los campos con "),e("span",{class:"text-red-500"},"*"),x(" son obligatorios ")],-1),fe={class:"flex flex-wrap -mx-4"},he={class:"sm:col-span-2"},xe={class:"sm:col-span-1",hidden:""},ve=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1),ye={class:"mt-2"},_e=["id"],Ue={class:"sm:col-span-2 px-4"},$e=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1),we={class:"mt-2"},Se=["id"],Oe={key:0,class:"text-red-500 text-xs mt-1"},ke={class:"sm:col-span-2 px-4"},De=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Ruta "),e("span",{class:"text-red-500"},"*")],-1),Ee={class:"mt-2"},Ce=["id"],je=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1),Re=["value"],Be={key:0,class:"text-red-500 text-xs mt-1"},Ie={class:"sm:col-span-2 px-4"},Ae=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1),Te={class:"mt-2"},Ne=["id"],Me=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1),Fe=["value"],Le={class:"sm:col-span-2 px-4"},We=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1),ze={class:"mt-2"},qe=["id"],Pe=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1),Qe=["value"],Ge={key:0,class:"text-red-500 text-xs mt-1"},Ve={class:"mt-6 flex items-center justify-end gap-x-6"},He=["id"],Xe=e("i",{class:"fa-solid fa-ban"},null,-1),Ye=["disabled"],Je=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Ke={__name:"FormularioUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:i}){const m=o,C=i,t=q({idUnidad:m.unidad.idUnidad,numeroUnidad:m.unidad.numeroUnidad,ruta:m.unidad.idRuta,operador:m.unidad.idOperador,directivo:m.directivo.idDirectivo});z(()=>m.unidad,async h=>{t.idUnidad=h.idUnidad,t.numeroUnidad=h.numeroUnidad,t.ruta=h.idRuta,t.operador=h.idOperador,t.directivo=h.idDirectivo},{deep:!0});const c=S(""),u=S("");S("");const v=S(""),U=async()=>{C("close"),t.reset()},k=h=>typeof h=="string"&&h.trim()!=="",D=h=>h!=null,g=async()=>{c.value=k(t.numeroUnidad)?"":"Ingrese el número de la unidad",u.value=D(t.ruta)?"":"Selecciones la ruta",v.value=D(t.directivo)?"":"Seleccione el dueño de la unidad",!(c.value||u.value||v.value)&&t.post(route("servicio.addUnidad"),{onSuccess:()=>{U(),c.value="",u.value="",v.value=""}})};return(h,d)=>(l(),P(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:U},{default:M(()=>[e("div",me,[e("form",{onSubmit:H(g,["prevent"])},[e("div",pe,[e("h2",ge,y(o.title),1),be,e("div",fe,[e("div",he,[e("div",xe,[ve,e("div",ye,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":d[0]||(d[0]=a=>r(t).idUnidad=a),placeholder:"Ingrese id de la unidad",id:"idUnidad"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,_e),[[V,r(t).idUnidad]])])])]),e("div",Ue,[$e,e("div",we,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+o.op,"onUpdate:modelValue":d[1]||(d[1]=a=>r(t).numeroUnidad=a),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Se),[[V,r(t).numeroUnidad]])]),c.value!=""?(l(),f("div",Oe,y(c.value),1)):j("",!0)]),e("div",ke,[De,e("div",Ee,[E(e("select",{name:"ruta",id:"ruta"+o.op,"onUpdate:modelValue":d[2]||(d[2]=a=>r(t).ruta=a),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[je,(l(!0),f(I,null,A(o.ruta,a=>(l(),f("option",{key:a.idRuta,value:a.idRuta},y(a.nombreRuta),9,Re))),128))],8,Ce),[[T,r(t).ruta]])]),u.value!=""?(l(),f("div",Be,y(u.value),1)):j("",!0)]),e("div",Ie,[Ae,e("div",Te,[E(e("select",{name:"operador",id:"operador"+o.op,"onUpdate:modelValue":d[3]||(d[3]=a=>r(t).operador=a),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Me,(l(!0),f(I,null,A(o.operadoresDisp,a=>(l(),f("option",{key:a.idOperador,value:a.idOperador},y(a.nombre_completo),9,Fe))),128))],8,Ne),[[T,r(t).operador]])])]),e("div",Le,[We,e("div",ze,[E(e("select",{name:"directivo",id:"directivo"+o.op,"onUpdate:modelValue":d[4]||(d[4]=a=>r(t).directivo=a),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Pe,(l(!0),f(I,null,A(o.directivo,a=>(l(),f("option",{key:a.idDirectivo,value:a.idDirectivo},y(a.nombre_completo),9,Qe))),128))],8,qe),[[T,r(t).directivo]])]),v.value!=""?(l(),f("div",Ge,y(v.value),1)):j("",!0)])])]),e("div",Ve,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:U},[Xe,x(" Cancelar")],8,He),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:r(t).processing},[Je,x("Guardar")],8,Ye)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Ze={class:"mt-2 bg-white p-4 shadow rounded-lg"},et={class:"border-b border-gray-900/10 pb-12"},tt={class:"text-base font-semibold leading-7 text-gray-900"},dt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Modifique los datos según sea necesario y guarde los cambios. ",-1),ot={class:"flex flex-wrap -mx-4"},at={class:"sm:col-span-2"},it={class:"sm:col-span-1",hidden:""},st=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1),nt={class:"mt-2"},rt=["id"],lt={class:"sm:col-span-2 px-4"},ct=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1),ut={class:"mt-2"},mt=["id"],pt={key:0,class:"text-red-500 text-xs mt-1"},gt={class:"sm:col-span-2 px-4"},bt=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Ruta "),e("span",{class:"text-red-500"},"*")],-1),ft={class:"mt-2"},ht=["id"],xt=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1),vt=["value"],yt={key:0,class:"text-red-500 text-xs mt-1"},_t={class:"sm:col-span-2 px-4"},Ut=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1),$t={class:"mt-2"},wt={class:"block rounded-md py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 sm:text-sm sm:leading-6"},St={class:"sm:col-span-2 px-4"},Ot=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1),kt={class:"mt-2"},Dt=["id"],Et=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1),Ct=["value"],jt={key:0,class:"text-red-500 text-xs mt-1"},Rt={class:"mt-6 flex items-center justify-end gap-x-6"},Bt=["id"],It=e("i",{class:"fa-solid fa-ban"},null,-1),At=["disabled"],Tt=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Nt={__name:"FormularioActualizarUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:i}){const m=o,C=i,t=q({_method:"PUT",idUnidad:m.unidad.idUnidad,numeroUnidad:m.unidad.numeroUnidad,ruta:m.unidad.idRuta,operador:m.unidad.idOperador,directivo:m.unidad.idDirectivo});z(()=>m.unidad,async d=>{t.idUnidad=d.idUnidad,t.numeroUnidad=d.numeroUnidad,t.ruta=d.idRuta,t.operador=d.idOperador,t.directivo=d.idDirectivo},{deep:!0});const c=S(""),u=S("");S("");const v=S(""),U=async()=>{C("close"),t.reset()},k=d=>typeof d=="string"&&d.trim()!=="",D=d=>d!=null,g=async()=>{if(c.value=k(t.numeroUnidad)?"":"Ingrese el número de la unidad",u.value=D(t.ruta)?"":"Selecciones la ruta",v.value=D(t.directivo)?"":"Seleccione el dueño de la unidad",!(c.value||u.value||v.value)){var d=document.getElementById("idUnidad2").value;t.post(route("servicio.actualizarUnidad",d),{onSuccess:()=>{U(),c.value="",u.value="",v.value=""}})}},h=d=>{const a=m.operador.find(s=>s.idOperador===d);return a?a.nombre_completo:"Operador no encontrado"};return(d,a)=>(l(),P(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:U},{default:M(()=>[e("div",Ze,[e("form",{onSubmit:H(g,["prevent"])},[e("div",et,[e("h2",tt,y(o.title),1),dt,e("div",ot,[e("div",at,[e("div",it,[st,e("div",nt,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":a[0]||(a[0]=s=>r(t).idUnidad=s),placeholder:"Ingrese id de la unidad",id:"idUnidad"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,rt),[[V,r(t).idUnidad]])])])]),e("div",lt,[ct,e("div",ut,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+o.op,"onUpdate:modelValue":a[1]||(a[1]=s=>r(t).numeroUnidad=s),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,mt),[[V,r(t).numeroUnidad]])]),c.value!=""?(l(),f("div",pt,y(c.value),1)):j("",!0)]),e("div",gt,[bt,e("div",ft,[E(e("select",{name:"ruta",id:"ruta"+o.op,"onUpdate:modelValue":a[2]||(a[2]=s=>r(t).ruta=s),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[xt,(l(!0),f(I,null,A(o.ruta,s=>(l(),f("option",{key:s.idRuta,value:s.idRuta},y(s.nombreRuta),9,vt))),128))],8,ht),[[T,r(t).ruta]])]),u.value!=""?(l(),f("div",yt,y(u.value),1)):j("",!0)]),e("div",_t,[Ut,e("div",$t,[e("p",wt,y(h(r(t).operador)),1)])]),e("div",St,[Ot,e("div",kt,[E(e("select",{name:"directivo",id:"directivo"+o.op,"onUpdate:modelValue":a[3]||(a[3]=s=>r(t).directivo=s),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Et,(l(!0),f(I,null,A(o.directivo,s=>(l(),f("option",{key:s.idDirectivo,value:s.idDirectivo},y(s.nombre_completo),9,Ct))),128))],8,Dt),[[T,r(t).directivo]])]),v.value!=""?(l(),f("div",jt,y(v.value),1)):j("",!0)])])]),e("div",Rt,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:U},[It,x(" Cancelar")],8,Bt),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:r(t).processing},[Tt,x("Guardar")],8,At)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Mt={class:"mt-2 bg-white p-4 shadow rounded-lg"},Ft={class:"border-b border-gray-900/10 pb-12"},Lt={class:"text-base font-semibold leading-7 text-gray-900"},Wt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Rellene el formulario para poder asignar un operador a una unidad. ",-1),zt={class:"flex flex-wrap -mx-4"},qt={class:"sm:col-span-2 px-4"},Pt=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Unidad "),e("span",{class:"text-red-500"},"*")],-1),Qt={class:"mt-2"},Gt=["id"],Vt=e("option",{value:"",disabled:"",selected:""},"Seleccione la unidad",-1),Ht=["value"],Xt={key:0,class:"text-red-500 text-xs mt-1"},Yt={class:"sm:col-span-2 px-4"},Jt=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Operador "),e("span",{class:"text-red-500"},"*")],-1),Kt={class:"mt-2"},Zt=["id"],ed=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1),td=["value"],dd={key:0,class:"text-red-500 text-xs mt-1"},od={class:"mt-6 flex items-center justify-end gap-x-6"},ad=["id"],id=e("i",{class:"fa-solid fa-ban"},null,-1),sd=["disabled"],nd=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),rd={__name:"FormularioAsignarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesDisp:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:i}){const m=o,C=i,t=q({idUnidad:m.unidad.idUnidad,unidad:m.unidad.idUnidad,operador:m.unidad.idOperador});z(()=>m.unidad,async d=>{t.idUnidad=d.idUnidad,t.unidad=d.idUnidad,t.operador=d.idOperador},{deep:!0});const c=S(""),u=S(""),v=ee(()=>{const d=m.unidadesDisp.find(a=>a.idUnidad===t.unidad);return d?d.idDirectivo:null}),U=ee(()=>{const d=v.value;return d?m.operadoresDisp.filter(a=>a.idDirectivo===d).sort((a,s)=>a.nombre_completo.localeCompare(s.nombre_completo)):[]});z(()=>t.unidad,d=>{t.operador="",u.value=""},{deep:!0});const k=async()=>{C("close"),t.reset()},D=d=>d!=null,g=async()=>{c.value=D(t.unidad)?"":"Seleccione la unidad",u.value=D(t.operador)?"":"Seleccione el operador",!(c.value||u.value)&&t.post(route("servicio.asignarOperador"),{onSuccess:()=>{k(),c.value="",u.value=""}})},h=async()=>{if(numeroUnidadError.value=D(t.unidad)?"":"Seleccione la unidad",u.value=D(t.operador)?"":"Seleccione el operador",!(c.value||u.value)){var d=document.getElementById("idUnidad2").value;console.log("idUnidad:"+d),t.put(route("principal.actualizarUnidad",d),{onSuccess:()=>{k(),console.log("idUnidad Editando:"+d),c.value="",u.value=""}})}};return(d,a)=>(l(),P(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:k},{default:M(()=>[e("div",Mt,[e("form",{onSubmit:a[2]||(a[2]=H(s=>o.op==="1"?g():h(),["prevent"]))},[e("div",Ft,[e("h2",Lt,y(o.title),1),Wt,e("div",zt,[e("div",qt,[Pt,e("div",Qt,[E(e("select",{name:"unidad",id:"unidad"+o.op,"onUpdate:modelValue":a[0]||(a[0]=s=>r(t).unidad=s),placeholder:"Seleccione la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Vt,(l(!0),f(I,null,A(o.unidadesDisp,s=>(l(),f("option",{key:s.idUnidad,value:s.idUnidad},y(s.numeroUnidad),9,Ht))),128))],8,Gt),[[T,r(t).unidad]])]),c.value!=""?(l(),f("div",Xt,y(c.value),1)):j("",!0)]),e("div",Yt,[Jt,e("div",Kt,[E(e("select",{name:"operador",id:"operador"+o.op,"onUpdate:modelValue":a[1]||(a[1]=s=>r(t).operador=s),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[ed,(l(!0),f(I,null,A(U.value,s=>(l(),f("option",{key:s.idOperador,value:s.idOperador},y(s.nombre_completo),9,td))),128))],8,Zt),[[T,r(t).operador]])]),u.value!=""?(l(),f("div",dd,y(u.value),1)):j("",!0)])])]),e("div",od,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:k},[id,x(" Cancelar")],8,ad),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:r(t).processing},[nd,x("Guardar")],8,sd)])],32)])]),_:1},8,["show","max-width","closeable"]))}},ld={class:"mt-2 bg-white p-4 shadow rounded-lg"},cd={class:"border-b border-gray-900/10 pb-12"},ud={class:"text-base font-semibold leading-7 text-gray-900"},md=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Seleccione la unidad a la que le quiere quitar el operador. ",-1),pd={class:"flex flex-wrap -mx-4"},gd={class:"sm:col-span-2 px-4"},bd=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Unidad "),e("span",{class:"text-red-500"},"*")],-1),fd={class:"mt-2"},hd=["id"],xd=e("option",{value:"",disabled:"",selected:""},"Seleccione la unidad",-1),vd=["value"],yd={key:0,class:"text-red-500 text-xs mt-1"},_d={class:"mt-6 flex items-center justify-end gap-x-6"},Ud=["id"],$d=e("i",{class:"fa-solid fa-ban"},null,-1),wd=["disabled"],Sd=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Od={__name:"FormularioQuitarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesConOperador:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:i}){const m=o,C=i,t=q({idUnidad:m.unidad.idUnidad,unidad:m.unidad.idUnidad,operador:m.unidad.idOperador});z(()=>m.unidad,async g=>{t.idUnidad=g.idUnidad,t.unidad=g.idUnidad,t.operador=g.idOperador},{deep:!0});const c=S(""),u=S(""),v=async()=>{C("close"),t.reset()},U=g=>g!=null,k=async()=>{c.value=U(t.unidad)?"":"Seleccione la unidad",!c.value&&t.post(route("servicio.quitarOperador"),{onSuccess:()=>{v(),c.value=""}})},D=async()=>{if(numeroUnidadError.value=U(t.unidad)?"":"Seleccione la unidad",u.value=U(t.operador)?"":"Seleccione el operador",!(c.value||u.value)){var g=document.getElementById("idUnidad2").value;console.log("idUnidad:"+g),t.put(route("servicio.actualizarUnidad",g),{onSuccess:()=>{v(),console.log("idUnidad Editando:"+g),c.value="",u.value=""}})}};return(g,h)=>(l(),P(X,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:v},{default:M(()=>[e("div",ld,[e("form",{onSubmit:h[1]||(h[1]=H(d=>o.op==="1"?k():D(),["prevent"]))},[e("div",cd,[e("h2",ud,y(o.title),1),md,e("div",pd,[e("div",gd,[bd,e("div",fd,[E(e("select",{name:"unidad",id:"unidad"+o.op,"onUpdate:modelValue":h[0]||(h[0]=d=>r(t).unidad=d),placeholder:"Seleccione la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[xd,(l(!0),f(I,null,A(o.unidadesConOperador,d=>(l(),f("option",{key:d.idUnidad,value:d.idUnidad},y(d.numeroUnidad),9,vd))),128))],8,hd),[[T,r(t).unidad]])]),c.value!=""?(l(),f("div",yd,y(c.value),1)):j("",!0)])])]),e("div",_d,[e("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:v},[$d,x(" Cancelar")],8,Ud),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:r(t).processing},[Sd,x("Guardar")],8,wd)])],32)])]),_:1},8,["show","max-width","closeable"]))}},kd={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},Dd=e("h2",{class:"font-bold text-center text-xl pt-0"},"Unidades",-1),Ed=e("div",{class:"my-1"},null,-1),Cd=e("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1),jd={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},Rd=e("i",{class:"fa fa-plus mr-2"},null,-1),Bd=e("i",{class:"fa fa-trash mr-2"},null,-1),Id=e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),Ad=e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),Td=e("thead",null,[e("tr",{class:"text-sm leading-normal"},[e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Número de Unidad "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Operador "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Ruta "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Dueño de la unidad ")])],-1),Q="xl",G=!0,Gd={__name:"Unidades",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object},ruta:{type:Object},operador:{type:Object},directivo:{type:Object},operadoresDisp:{type:Object},unidadesDisp:{type:Object},unidadesConOperador:{type:Object},usuario:{type:Object}},setup(o){Y.use(te),Y.use(te);const i=o,m=(p="Documento")=>{const n=new ce("landscape");n.setFontSize(12),n.text(p,14,22);const b=new Date().toLocaleDateString();n.setFontSize(8),n.text(`Fecha: ${b}`,260,22);const w=["ID","Número De Unidad","Operador","Ruta","Dueño De La Uniad"],_=[];de(()=>{$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().each(R=>{var L,B,Z;_.push([R.idUnidad,R.numeroUnidad,((L=i.operador.find(W=>W.idOperador===R.idOperador))==null?void 0:L.nombre_completo)||"",((B=i.ruta.find(W=>W.idRuta===R.idRuta))==null?void 0:B.nombreRuta)||"",((Z=i.directivo.find(W=>W.idDirectivo===R.idDirectivo))==null?void 0:Z.nombre_completo)||""])}),n.autoTable({head:[w],body:_,startY:24}),n.save(`${p}.pdf`)})},C=()=>{de(()=>{const b=$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().toArray().map(O=>{var F,R,L;return{ID:O.idUnidad,"Número De Unidad":O.numeroUnidad,Operador:((F=i.operador.find(B=>B.idOperador===O.idOperador))==null?void 0:F.nombre_completo)||"",Ruta:((R=i.ruta.find(B=>B.idRuta===O.idRuta))==null?void 0:R.nombreRuta)||"","Dueño De La Unidad":((L=i.directivo.find(B=>B.idDirectivo===O.idDirectivo))==null?void 0:L.nombre_completo)||""}}),w=K.json_to_sheet(b),_=K.book_new();K.book_append_sheet(_,w,"Operadores Registrados"),ue(_,"Operadores Registrados.xlsx")})},t=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2]},button:!0},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>C()},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",orientation:"landscape",action:()=>m(i.title||"Unidades Registradas")},{title:"Unidades registradas",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[2,3,4,5,6]}}],c=[{data:null,render:function(p,n,b,w){return""}},{data:null,render:function(p,n,b,w){return`<input type="checkbox" class="unidades-checkboxes" data-id="${b.idUnidad}" ">`}},{data:null,render:function(p,n,b,w){return w.row+1}},{data:"numeroUnidad"},{data:"idOperador",render:function(p,n,b,w){if(p){const _=i.operador.find(O=>O.idOperador===p);return _?_.nombre_completo:""}else return'<span style="color: red;">Sin asignar</span>'}},{data:"idRuta",render:function(p,n,b,w){const _=i.ruta.find(O=>O.idRuta===p);return _?_.nombreRuta:""}},{data:"idDirectivo",render:function(p,n,b,w){const _=i.directivo.find(O=>O.idDirectivo===p);return _?_.nombre_completo:""}},{data:null,render:function(p,n,b,w){return`<button class="editar-button" data-id="${b.idUnidad}" style="display: flex; justify-content: center;"><i class="fa fa-pencil"></i></button>`}}],u=S(!1),v=S(!1),U=S(!1),k=S(!1),D=q({_method:"DELETE"}),g=S([]);var h={};const d=p=>{h=p,k.value=!0},a=()=>{u.value=!1},s=()=>{v.value=!1},oe=()=>{U.value=!1},ae=()=>{k.value=!1},ie=p=>{g.value.includes(p)?g.value=g.value.filter(b=>b!==p):g.value.push(p);const n=document.getElementById("eliminarABtn");g.value.length>0?n.removeAttribute("disabled"):n.setAttribute("disabled","")};ne(()=>{document.getElementById("unidadesTablaId").addEventListener("click",p=>{const n=p.target;if(n.classList.contains("unidades-checkboxes")){const b=parseInt(n.getAttribute("data-id"));if(i.unidad){const w=i.unidad.find(_=>_.idUnidad===b);w?ie(w):console.log("No se tiene unidad")}}}),$("#unidadesTablaId").on("click",".editar-button",function(){const p=$(this).data("id"),n=i.unidad.find(b=>b.idUnidad===p);d(n)})});const se=()=>{const p=J.mixin({buttonsStyling:!0}),n=g.value.map(b=>b.numeroUnidad).join(", ");p.fire({title:"¿Estas seguro que deseas eliminar la(s) unidad(es) seleccionada(s)?",html:`Unidades seleccionadas: ${n}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async b=>{if(b.isConfirmed)try{const _=g.value.map(F=>F.idUnidad).join(",");await D.post(route("servicio.eliminarUnidad",_)),g.value=[];const O=document.getElementById("eliminarABtn");g.value.length>0?O.removeAttribute("disabled"):O.setAttribute("disabled",""),J.fire({title:"Unidad(es) eliminado(s) correctamente",icon:"success"}),window.flash={message:"Unidad(es) eliminado(s) correctamente",color:"green"}}catch(w){console.log("Error al eliminar varias unidades: "+w),J.fire({title:"Error",text:"Hubo un error al eliminar las unidades. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(p,n)=>(l(),P(le,{title:"Formar Unidades",usuario:i.usuario},{default:M(()=>[e("div",kd,[Dd,Ed,Cd,N(re),e("div",jd,[e("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:n[0]||(n[0]=b=>u.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Rd,x("Agregar Unidad ")]),e("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:se},[Bd,x("Borrar Unidad ")]),e("button",{class:"bg-cyan-500 hover:bg-cyan-500 text-white font-semibold py-2 px-4 rounded",onClick:n[1]||(n[1]=b=>v.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Id,x(" Asignar Operador ")]),e("button",{class:"bg-orange-500 hover:bg-orange-500 text-white font-semibold py-2 px-4 rounded",onClick:n[2]||(n[2]=b=>U.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Ad,x(" Quitar Operador ")])]),e("div",null,[N(r(Y),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"unidadesTablaId",name:"unidadesTablaId",columns:c,data:o.unidad,options:{responsive:!0,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primero",previous:"Anterior",next:"Siguiente",last:"Ultimo"}},buttons:[t],pageLength:20}},{default:M(()=>[Td]),_:1},8,["data","options"])])]),N(Ke,{show:u.value,"max-width":Q,closeable:G,onClose:a,title:"Añadir unidad",op:"1",modal:"modalCreate",unidad:i.unidad,ruta:i.ruta,operadoresDisp:i.operadoresDisp,directivo:i.directivo},null,8,["show","unidad","ruta","operadoresDisp","directivo"]),N(Nt,{show:k.value,"max-width":Q,closeable:G,onClose:ae,title:"Editar unidad",op:"2",modal:"modalEdit",unidad:r(h),ruta:i.ruta,operador:i.operador,operadoresDisp:i.operadoresDisp,directivo:i.directivo},null,8,["show","unidad","ruta","operador","operadoresDisp","directivo"]),N(rd,{show:v.value,"max-width":Q,closeable:G,onClose:s,title:"Asignar operador",op:"1",modal:"modalCreate",unidad:i.unidad,unidadesDisp:i.unidadesDisp,operadoresDisp:i.operadoresDisp},null,8,["show","unidad","unidadesDisp","operadoresDisp"]),N(Od,{show:U.value,"max-width":Q,closeable:G,onClose:oe,title:"Quitar operador",op:"1",modal:"modalCreate",unidad:i.unidad,unidadesConOperador:i.unidadesConOperador,operadoresDisp:i.operadoresDisp},null,8,["show","unidad","unidadesConOperador","operadoresDisp"])]),_:1},8,["usuario"]))}};export{Gd as default};
