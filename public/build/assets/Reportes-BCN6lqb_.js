import{_ as U,a as z,b as B,c as D,d as R,e as V,f as P,g as K}from"./ReportesUltimasCorridas-DyyYGYod.js";import{_ as L}from"./ServicioLayout-DUlW_sZY.js";import{r as Y,I as G,o as l,c,m as f,a as t,t as _,w,p as $,d as g,J as I,F as b,l as q,n as k,f as J,E as M,j as H,e as Q,b as d}from"./app-GjlyjCeG.js";import{S as h}from"./sweetalert2.all-BeRCN0Nn.js";import{u as x,w as W}from"./xlsx-769MyM77.js";import{E as X}from"./jspdf.plugin.autotable-DmkYXTd5.js";/* empty css                                                               */const Z={class:"text-lg font-bold"},ee=t("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1),oe={class:"flex flex-wrap gap-4 mb-3"},ae={class:"flex flex-wrap space-x-3 mb-2"},re=t("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1),te=["onUpdate:modelValue"],ne=t("option",{value:"semana"},"Semanal",-1),se=[ne],de=["value"],ie={class:"flex flex-wrap space-x-3"},le=["onClick"],j=2024,ce={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(y){const o=Y([]),S=G({unidad:null,operador:null}),v=async n=>{const r=route("reporte.opSinTrabajar",{semana:n});console.log("URL de la API:",r);try{const e=await M.get(r);o.value=Object.values(e.data),console.log("Entradas.value",o.value),console.log("response.data",e.data)}catch(e){console.error("Error al obtener los datos:",e.response?e.response.data:e.message),h.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},O=async(n,r,e,a)=>{if(console.log("Semana seleccionada:",s),!s){h.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await v(s),n.titulo==="Operadores Sin Trabajar"&&(r==="pdf"?E(n.titulo,s):r==="excel"&&C(n.titulo,s))}catch{h.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},E=(n,r)=>{const e=new X("portrait");e.setFontSize(12),e.text(`Reporte de ${n} - Semana ${r}`,14,20),e.setFontSize(10),e.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const a=[{header:"Nombre del operador",dataKey:"nombre"}],i=o.value.map(m=>({nombre:m.nombre_completo||"N/A"}));e.autoTable({columns:a,body:i,startY:24,styles:{fontSize:10}});const u=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});e.setFontSize(10),e.text(`Fecha de creación: ${u}`,14,e.internal.pageSize.height-10);const p=`${n}-Semana-${r}.pdf`;e.save(p)},C=(n,r)=>{const e=`${n}-Semana-${r}.xlsx`,a=[["Nombre del Operador"]];o.value.forEach(p=>{const m=p.nombre_completo||"N/A";a.push([m])});const i=x.book_new(),u=x.aoa_to_sheet(a);x.book_append_sheet(i,u,"Operadores_Sin_Trabajar"),W(i,e)},F=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],N=Array.from({length:52},(n,r)=>r+1),T=new Date().getFullYear();Array.from({length:T-j+1},(n,r)=>j+r);let s=1;const A=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(n,r)=>(l(),c(b,null,f(A,e=>t("div",{key:e.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[t("h3",Z,_(e.titulo),1),ee,t("div",oe,[t("div",ae,[re,w(t("select",{"onUpdate:modelValue":a=>e.periodoSeleccionado=a,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},se,8,te),[[$,e.periodoSeleccionado]]),e.periodoSeleccionado==="semana"?w((l(),c("select",{key:0,"onUpdate:modelValue":r[0]||(r[0]=a=>I(s)?s.value=a:s=a),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(l(!0),c(b,null,f(g(N),(a,i)=>(l(),c("option",{key:i,value:a},"Semana "+_(a),9,de))),128))],512)),[[$,g(s)]]):q("",!0)])]),t("div",ie,[(l(),c(b,null,f(F,a=>t("button",{key:a.tipo,class:k(a.clase),onClick:i=>O(e,a.tipo,S.operador,{tipo:e.periodoSeleccionado,valor:e.periodoSeleccionado==="semana"?g(s):""})},[t("i",{class:k(a.icono+" mr-2 jump-icon")},null,2),J(" "+_(a.texto),1)],10,le)),64))])])),64))}},ue={class:"mt-1 bg-white p-4 shadow rounded-lg h-5/6"},pe=t("h2",{class:"font-bold text-center text-xl pt-0 mb-2"},"Reportes",-1),me=t("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-2"},null,-1),Se={__name:"Reportes",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},tipoUltimaCorrida:{type:Object,default:()=>({})}},setup(y){const o=y;return(S,v)=>(l(),H(L,{title:"Reportes",usuario:o.usuario},{default:Q(()=>[t("div",ue,[pe,me,d(U,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(z,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(B,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(D,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(R,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(V,{unidad:o.unidad,operador:o.operador,tipoUltimaCorrida:o.tipoUltimaCorrida},null,8,["unidad","operador","tipoUltimaCorrida"]),d(P,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(K,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(ce,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"])])]),_:1},8,["usuario"]))}};export{Se as default};
