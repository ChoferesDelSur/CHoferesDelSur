import{u as V,i as z,r as S,o as g,j as q,e as M,a as e,g as H,t as y,w as E,d as n,k as G,c as v,l as j,F as A,m as T,p as N,f as x,q as ee,b as I,K as ae,L as X,D as te,s as re,x as de}from"./app-BH2FP5Es.js";import"./buttons.print-BSLV8GpE.js";import{S as Y}from"./sweetalert2.all-CjrOOPYt.js";import{_ as le}from"./Mensaje-BZxFGBY3.js";import{_ as ce}from"./ServicioLayout-Cj-r23fv.js";import{_ as K}from"./Modal-GKd96d8N.js";/* empty css                   */import{E as ue}from"./jspdf.plugin.autotable-i8pxocC8.js";import{u as J,w as me}from"./xlsx-769MyM77.js";/* empty css                                                */const pe={class:"mt-2 bg-white p-4 shadow rounded-lg"},ge={class:"border-b border-gray-900/10 pb-12"},be={class:"text-base font-semibold leading-7 text-gray-900"},fe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},[x("Rellene el formulario para poder registrar una unidad. Los campos con "),e("span",{class:"text-red-500"},"*"),x(" son obligatorios ")],-1),he={class:"flex flex-wrap -mx-4"},xe={class:"sm:col-span-2"},ve={class:"sm:col-span-1",hidden:""},ye=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1),_e={class:"mt-2"},Ue=["id"],$e={class:"sm:col-span-2 px-4"},we=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1),Se={class:"mt-2"},Oe=["id"],De={key:0,class:"text-red-500 text-xs mt-1"},ke={class:"sm:col-span-2 px-4"},Ee=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Ruta "),e("span",{class:"text-red-500"},"*")],-1),Ce={class:"mt-2"},je=["id"],Re=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1),Be=["value"],Ie={key:0,class:"text-red-500 text-xs mt-1"},Ae={class:"sm:col-span-2 px-4"},Te=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1),Ne={class:"mt-2"},Me=["id"],Fe=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1),Le=["value"],We={class:"sm:col-span-2 px-4"},ze=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1),Ve={class:"mt-2"},qe=["id"],Pe=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1),Qe=["value"],Ge={key:0,class:"text-red-500 text-xs mt-1"},He={class:"mt-6 flex items-center justify-end gap-x-6"},Ke=["id"],Xe=e("i",{class:"fa-solid fa-ban"},null,-1),Ye=["disabled"],Je=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Ze={__name:"FormularioUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(a,{emit:i}){const u=a,C=i,t=V({idUnidad:u.unidad.idUnidad,numeroUnidad:u.unidad.numeroUnidad,ruta:u.unidad.idRuta,operador:u.unidad.idOperador,directivo:u.directivo.idDirectivo});z(()=>u.unidad,async f=>{t.idUnidad=f.idUnidad,t.numeroUnidad=f.numeroUnidad,t.ruta=f.idRuta,t.operador=f.idOperador,t.directivo=f.idDirectivo},{deep:!0});const l=S(""),c=S("");S("");const h=S(""),U=async()=>{C("close"),t.reset()},D=f=>typeof f=="string"&&f.trim()!=="",k=f=>f!=null,p=async()=>{l.value=D(t.numeroUnidad)?"":"Ingrese el número de la unidad",c.value=k(t.ruta)?"":"Selecciones la ruta",h.value=k(t.directivo)?"":"Seleccione el dueño de la unidad",!(l.value||c.value||h.value)&&t.post(route("servicio.addUnidad"),{onSuccess:()=>{U(),l.value="",c.value="",h.value=""}})};return(f,d)=>(g(),q(K,{show:a.show,"max-width":a.maxWidth,closeable:a.closeable,onClose:U},{default:M(()=>[e("div",pe,[e("form",{onSubmit:H(p,["prevent"])},[e("div",ge,[e("h2",be,y(a.title),1),fe,e("div",he,[e("div",xe,[e("div",ve,[ye,e("div",_e,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":d[0]||(d[0]=o=>n(t).idUnidad=o),placeholder:"Ingrese id de la unidad",id:"idUnidad"+a.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Ue),[[G,n(t).idUnidad]])])])]),e("div",$e,[we,e("div",Se,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+a.op,"onUpdate:modelValue":d[1]||(d[1]=o=>n(t).numeroUnidad=o),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Oe),[[G,n(t).numeroUnidad]])]),l.value!=""?(g(),v("div",De,y(l.value),1)):j("",!0)]),e("div",ke,[Ee,e("div",Ce,[E(e("select",{name:"ruta",id:"ruta"+a.op,"onUpdate:modelValue":d[2]||(d[2]=o=>n(t).ruta=o),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Re,(g(!0),v(A,null,T(a.ruta,o=>(g(),v("option",{key:o.idRuta,value:o.idRuta},y(o.nombreRuta),9,Be))),128))],8,je),[[N,n(t).ruta]])]),c.value!=""?(g(),v("div",Ie,y(c.value),1)):j("",!0)]),e("div",Ae,[Te,e("div",Ne,[E(e("select",{name:"operador",id:"operador"+a.op,"onUpdate:modelValue":d[3]||(d[3]=o=>n(t).operador=o),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Fe,(g(!0),v(A,null,T(a.operadoresDisp,o=>(g(),v("option",{key:o.idOperador,value:o.idOperador},y(o.nombre_completo),9,Le))),128))],8,Me),[[N,n(t).operador]])])]),e("div",We,[ze,e("div",Ve,[E(e("select",{name:"directivo",id:"directivo"+a.op,"onUpdate:modelValue":d[4]||(d[4]=o=>n(t).directivo=o),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Pe,(g(!0),v(A,null,T(a.directivo,o=>(g(),v("option",{key:o.idDirectivo,value:o.idDirectivo},y(o.nombre_completo),9,Qe))),128))],8,qe),[[N,n(t).directivo]])]),h.value!=""?(g(),v("div",Ge,y(h.value),1)):j("",!0)])])]),e("div",He,[e("button",{type:"button",id:"cerrar"+a.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:U},[Xe,x(" Cancelar")],8,Ke),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(t).processing},[Je,x("Guardar")],8,Ye)])],32)])]),_:1},8,["show","max-width","closeable"]))}},et={class:"mt-2 bg-white p-4 shadow rounded-lg"},tt={class:"border-b border-gray-900/10 pb-12"},dt={class:"text-base font-semibold leading-7 text-gray-900"},at=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Modifique los datos según sea necesario y guarde los cambios. ",-1),ot={class:"flex flex-wrap -mx-4"},it={class:"sm:col-span-2"},st={class:"sm:col-span-1",hidden:""},nt=e("label",{for:"idUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},"idUnidad",-1),rt={class:"mt-2"},lt=["id"],ct={class:"sm:col-span-2 px-4"},ut=e("label",{for:"numeroUnidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Número de unidad "),e("span",{class:"text-red-500"},"*")],-1),mt={class:"mt-2"},pt=["id"],gt={key:0,class:"text-red-500 text-xs mt-1"},bt={class:"sm:col-span-2 px-4"},ft=e("label",{for:"ruta",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Ruta "),e("span",{class:"text-red-500"},"*")],-1),ht={class:"mt-2"},xt=["id"],vt=e("option",{value:"",disabled:"",selected:""},"Seleccione la ruta",-1),yt=["value"],_t={key:0,class:"text-red-500 text-xs mt-1"},Ut={class:"sm:col-span-2 px-4"},$t=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},"Operador",-1),wt={class:"mt-2"},St={class:"block rounded-md py-1.5 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 sm:text-sm sm:leading-6"},Ot={class:"sm:col-span-2 px-4"},Dt=e("label",{for:"directivo",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Dueño de la unidad "),e("span",{class:"text-red-500"},"*")],-1),kt={class:"mt-2"},Et=["id"],Ct=e("option",{value:"",disabled:"",selected:""},"Seleccione al dueño de la unidad",-1),jt=["value"],Rt={key:0,class:"text-red-500 text-xs mt-1"},Bt={class:"mt-6 flex items-center justify-end gap-x-6"},It=["id"],At=e("i",{class:"fa-solid fa-ban"},null,-1),Tt=["disabled"],Nt=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Mt={__name:"FormularioActualizarUnidades",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},ruta:{type:Object,default:()=>({})},directivo:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(a,{emit:i}){const u=a,C=i,t=V({_method:"PUT",idUnidad:u.unidad.idUnidad,numeroUnidad:u.unidad.numeroUnidad,ruta:u.unidad.idRuta,operador:u.unidad.idOperador,directivo:u.unidad.idDirectivo});z(()=>u.unidad,async d=>{t.idUnidad=d.idUnidad,t.numeroUnidad=d.numeroUnidad,t.ruta=d.idRuta,t.operador=d.idOperador,t.directivo=d.idDirectivo},{deep:!0});const l=S(""),c=S("");S("");const h=S(""),U=async()=>{C("close"),t.reset()},D=d=>typeof d=="string"&&d.trim()!=="",k=d=>d!=null,p=async()=>{if(l.value=D(t.numeroUnidad)?"":"Ingrese el número de la unidad",c.value=k(t.ruta)?"":"Selecciones la ruta",h.value=k(t.directivo)?"":"Seleccione el dueño de la unidad",!(l.value||c.value||h.value)){var d=document.getElementById("idUnidad2").value;t.post(route("servicio.actualizarUnidad",d),{onSuccess:()=>{U(),l.value="",c.value="",h.value=""}})}},f=d=>{const o=u.operador.find(s=>s.idOperador===d);return o?o.nombre_completo:"Operador no encontrado"};return(d,o)=>(g(),q(K,{show:a.show,"max-width":a.maxWidth,closeable:a.closeable,onClose:U},{default:M(()=>[e("div",et,[e("form",{onSubmit:H(p,["prevent"])},[e("div",tt,[e("h2",dt,y(a.title),1),at,e("div",ot,[e("div",it,[e("div",st,[nt,e("div",rt,[E(e("input",{type:"number",name:"idUnidad","onUpdate:modelValue":o[0]||(o[0]=s=>n(t).idUnidad=s),placeholder:"Ingrese id de la unidad",id:"idUnidad"+a.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,lt),[[G,n(t).idUnidad]])])])]),e("div",ct,[ut,e("div",mt,[E(e("input",{type:"text",name:"numeroUnidad",id:"numeroUnidad"+a.op,"onUpdate:modelValue":o[1]||(o[1]=s=>n(t).numeroUnidad=s),placeholder:"Ingrese el número de la unidad",class:"block w-60 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,pt),[[G,n(t).numeroUnidad]])]),l.value!=""?(g(),v("div",gt,y(l.value),1)):j("",!0)]),e("div",bt,[ft,e("div",ht,[E(e("select",{name:"ruta",id:"ruta"+a.op,"onUpdate:modelValue":o[2]||(o[2]=s=>n(t).ruta=s),placeholder:"Seleccione la ruta",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[vt,(g(!0),v(A,null,T(a.ruta,s=>(g(),v("option",{key:s.idRuta,value:s.idRuta},y(s.nombreRuta),9,yt))),128))],8,xt),[[N,n(t).ruta]])]),c.value!=""?(g(),v("div",_t,y(c.value),1)):j("",!0)]),e("div",Ut,[$t,e("div",wt,[e("p",St,y(f(n(t).operador)),1)])]),e("div",Ot,[Dt,e("div",kt,[E(e("select",{name:"directivo",id:"directivo"+a.op,"onUpdate:modelValue":o[3]||(o[3]=s=>n(t).directivo=s),placeholder:"Seleccione al dueño de la unidad",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Ct,(g(!0),v(A,null,T(a.directivo,s=>(g(),v("option",{key:s.idDirectivo,value:s.idDirectivo},y(s.nombre_completo),9,jt))),128))],8,Et),[[N,n(t).directivo]])]),h.value!=""?(g(),v("div",Rt,y(h.value),1)):j("",!0)])])]),e("div",Bt,[e("button",{type:"button",id:"cerrar"+a.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:U},[At,x(" Cancelar")],8,It),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(t).processing},[Nt,x("Guardar")],8,Tt)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Ft={class:"mt-2 bg-white p-4 shadow rounded-lg"},Lt={class:"border-b border-gray-900/10 pb-12"},Wt={class:"text-base font-semibold leading-7 text-gray-900"},zt=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Rellene el formulario para poder asignar un operador a una unidad. ",-1),Vt={class:"flex flex-wrap -mx-4"},qt={class:"sm:col-span-2 w-56 px-4"},Pt=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Unidad "),e("span",{class:"text-red-500"},"*")],-1),Qt={class:"mt-2"},Gt={key:0,class:"text-red-500 text-xs mt-1"},Ht={class:"sm:col-span-2 px-4"},Kt=e("label",{for:"operador",class:"block text-sm font-medium leading-6 text-gray-900"},[x("Operador "),e("span",{class:"text-red-500"},"*")],-1),Xt={class:"mt-2"},Yt=["id"],Jt=e("option",{value:"",disabled:"",selected:""},"Seleccione al operador para esta unidad",-1),Zt=["value"],ed={key:0,class:"text-red-500 text-xs mt-1"},td={class:"mt-6 flex items-center justify-end gap-x-6"},dd=["id"],ad=e("i",{class:"fa-solid fa-ban"},null,-1),od=["disabled"],id=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),sd={__name:"FormularioAsignarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesDisp:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(a,{emit:i}){const u=a,C=i,t=V({idUnidad:u.unidad.idUnidad,unidad:u.unidad.idUnidad,operador:u.unidad.idOperador});z(()=>u.unidad,async d=>{t.idUnidad=d.idUnidad,t.unidad=d.idUnidad,t.operador=d.idOperador},{deep:!0});const l=S(""),c=S(""),h=ee(()=>{const d=u.unidadesDisp.find(o=>o.idUnidad===t.unidad);return d?d.idDirectivo:null}),U=ee(()=>{const d=h.value;return d?u.operadoresDisp.filter(o=>o.idDirectivo===d).sort((o,s)=>o.nombre_completo.localeCompare(s.nombre_completo)):[]});z(()=>t.unidad,d=>{t.operador="",c.value=""},{deep:!0});const D=async()=>{C("close"),t.reset()},k=d=>d!=null,p=async()=>{l.value=k(t.unidad)?"":"Seleccione la unidad",c.value=k(t.operador)?"":"Seleccione el operador",!(l.value||c.value)&&t.post(route("servicio.asignarOperador"),{onSuccess:()=>{D(),l.value="",c.value=""}})},f=async()=>{if(numeroUnidadError.value=k(t.unidad)?"":"Seleccione la unidad",c.value=k(t.operador)?"":"Seleccione el operador",!(l.value||c.value)){var d=document.getElementById("idUnidad2").value;console.log("idUnidad:"+d),t.put(route("principal.actualizarUnidad",d),{onSuccess:()=>{D(),console.log("idUnidad Editando:"+d),l.value="",c.value=""}})}};return(d,o)=>(g(),q(K,{show:a.show,"max-width":a.maxWidth,closeable:a.closeable,onClose:D},{default:M(()=>[e("div",Ft,[e("form",{onSubmit:o[2]||(o[2]=H(s=>a.op==="1"?p():f(),["prevent"]))},[e("div",Lt,[e("h2",Wt,y(a.title),1),zt,e("div",Vt,[e("div",qt,[Pt,e("div",Qt,[I(n(ae),{modelValue:n(t).unidad,"onUpdate:modelValue":o[0]||(o[0]=s=>n(t).unidad=s),class:"w-full",options:a.unidadesDisp.map(s=>({label:s.numeroUnidad,value:s.idUnidad})),placeholder:"Seleccione la unidad",reduce:s=>s.value},null,8,["modelValue","options","reduce"])]),l.value!=""?(g(),v("div",Gt,y(l.value),1)):j("",!0)]),e("div",Ht,[Kt,e("div",Xt,[E(e("select",{name:"operador",id:"operador"+a.op,"onUpdate:modelValue":o[1]||(o[1]=s=>n(t).operador=s),placeholder:"Seleccione al operador",class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[Jt,(g(!0),v(A,null,T(U.value,s=>(g(),v("option",{key:s.idOperador,value:s.idOperador},y(s.nombre_completo),9,Zt))),128))],8,Yt),[[N,n(t).operador]])]),c.value!=""?(g(),v("div",ed,y(c.value),1)):j("",!0)])])]),e("div",td,[e("button",{type:"button",id:"cerrar"+a.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:D},[ad,x(" Cancelar")],8,dd),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(t).processing},[id,x("Guardar")],8,od)])],32)])]),_:1},8,["show","max-width","closeable"]))}},nd={class:"mt-2 bg-white p-4 shadow rounded-lg"},rd={class:"border-b border-gray-900/10 pb-12"},ld={class:"text-base font-semibold leading-7 text-gray-900"},cd=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},"Seleccione la unidad a la que le quiere quitar el operador. ",-1),ud={class:"sm:col-span-2 w-56 px-4"},md=e("label",{for:"unidad",class:"block text-sm font-medium leading-6 text-gray-900"},"Unidad",-1),pd={class:"mt-2"},gd={key:0,class:"text-red-500 text-xs mt-1"},bd={class:"mt-6 flex items-center justify-end gap-x-6"},fd=["id"],hd=e("i",{class:"fa-solid fa-ban"},null,-1),xd=["disabled"],vd=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),yd={__name:"FormularioQuitarOperador",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},unidad:{type:Object,default:()=>({})},operadoresDisp:{type:Object,default:()=>({})},unidadesConOperador:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(a,{emit:i}){const u=a,C=i,t=V({idUnidad:u.unidad.idUnidad,unidad:u.unidad.idUnidad,operador:u.unidad.idOperador});z(()=>u.unidad,async p=>{t.idUnidad=p.idUnidad,t.unidad=p.idUnidad,t.operador=p.idOperador},{deep:!0});const l=S(""),c=S(""),h=async()=>{C("close"),t.reset()},U=p=>p!=null,D=async()=>{l.value=U(t.unidad)?"":"Seleccione la unidad",!l.value&&t.post(route("servicio.quitarOperador"),{onSuccess:()=>{h(),l.value=""}})},k=async()=>{if(numeroUnidadError.value=U(t.unidad)?"":"Seleccione la unidad",c.value=U(t.operador)?"":"Seleccione el operador",!(l.value||c.value)){var p=document.getElementById("idUnidad2").value;console.log("idUnidad:"+p),t.put(route("servicio.actualizarUnidad",p),{onSuccess:()=>{h(),console.log("idUnidad Editando:"+p),l.value="",c.value=""}})}};return(p,f)=>(g(),q(K,{show:a.show,"max-width":a.maxWidth,closeable:a.closeable,onClose:h},{default:M(()=>[e("div",nd,[e("form",{onSubmit:f[1]||(f[1]=H(d=>a.op==="1"?D():k(),["prevent"]))},[e("div",rd,[e("h2",ld,y(a.title),1),cd,e("div",ud,[md,e("div",pd,[I(n(ae),{modelValue:n(t).unidad,"onUpdate:modelValue":f[0]||(f[0]=d=>n(t).unidad=d),options:a.unidadesConOperador.map(d=>({label:d.numeroUnidad,value:d.idUnidad})),placeholder:"Seleccione la unidad",reduce:d=>d.value,class:"w-full"},null,8,["modelValue","options","reduce"])]),l.value!=""?(g(),v("div",gd,y(l.value),1)):j("",!0)])]),e("div",bd,[e("button",{type:"button",id:"cerrar"+a.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:h},[hd,x(" Cancelar")],8,fd),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:n(t).processing},[vd,x("Guardar")],8,xd)])],32)])]),_:1},8,["show","max-width","closeable"]))}},_d={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},Ud=e("h2",{class:"font-bold text-center text-xl pt-0"},"Unidades",-1),$d=e("div",{class:"my-1"},null,-1),wd=e("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1),Sd={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},Od=e("i",{class:"fa fa-plus mr-2"},null,-1),Dd=e("i",{class:"fa fa-trash mr-2"},null,-1),kd=e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),Ed=e("i",{class:"fa fa-male","aria-hidden":"true"},null,-1),Cd=e("thead",null,[e("tr",{class:"text-sm leading-normal"},[e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Número de Unidad "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Operador "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Ruta "),e("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Dueño de la unidad ")])],-1),P="xl",Q=!0,Wd={__name:"Unidades",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object},ruta:{type:Object},operador:{type:Object},directivo:{type:Object},operadoresDisp:{type:Object},unidadesDisp:{type:Object},unidadesConOperador:{type:Object},usuario:{type:Object}},setup(a){X.use(te),X.use(te);const i=a,u=(m="Documento")=>{const r=new ue("landscape");r.setFontSize(12),r.text(m,14,22);const b=new Date().toLocaleDateString();r.setFontSize(8),r.text(`Fecha: ${b}`,260,22);const w=["ID","Número De Unidad","Operador","Ruta","Dueño De La Uniad"],_=[];de(()=>{$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().each(R=>{var L,B,Z;_.push([R.idUnidad,R.numeroUnidad,((L=i.operador.find(W=>W.idOperador===R.idOperador))==null?void 0:L.nombre_completo)||"",((B=i.ruta.find(W=>W.idRuta===R.idRuta))==null?void 0:B.nombreRuta)||"",((Z=i.directivo.find(W=>W.idDirectivo===R.idDirectivo))==null?void 0:Z.nombre_completo)||""])}),r.autoTable({head:[w],body:_,startY:24}),r.save(`${m}.pdf`)})},C=()=>{de(()=>{const b=$("#unidadesTablaId").DataTable().rows({search:"applied"}).data().toArray().map(O=>{var F,R,L;return{ID:O.idUnidad,"Número De Unidad":O.numeroUnidad,Operador:((F=i.operador.find(B=>B.idOperador===O.idOperador))==null?void 0:F.nombre_completo)||"",Ruta:((R=i.ruta.find(B=>B.idRuta===O.idRuta))==null?void 0:R.nombreRuta)||"","Dueño De La Unidad":((L=i.directivo.find(B=>B.idDirectivo===O.idDirectivo))==null?void 0:L.nombre_completo)||""}}),w=J.json_to_sheet(b),_=J.book_new();J.book_append_sheet(_,w,"Operadores Registrados"),me(_,"Operadores Registrados.xlsx")})},t=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2]},button:!0},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>C()},{title:"Unidades registradas",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",orientation:"landscape",action:()=>u(i.title||"Unidades Registradas")},{title:"Unidades registradas",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[2,3,4,5,6]}}],l=[{data:null,render:function(m,r,b,w){return""}},{data:null,render:function(m,r,b,w){return`<input type="checkbox" class="unidades-checkboxes" data-id="${b.idUnidad}" ">`}},{data:null,render:function(m,r,b,w){return w.row+1}},{data:"numeroUnidad"},{data:"idOperador",render:function(m,r,b,w){if(m){const _=i.operador.find(O=>O.idOperador===m);return _?_.nombre_completo:""}else return'<span style="color: red;">Sin asignar</span>'}},{data:"idRuta",render:function(m,r,b,w){const _=i.ruta.find(O=>O.idRuta===m);return _?_.nombreRuta:""}},{data:"idDirectivo",render:function(m,r,b,w){const _=i.directivo.find(O=>O.idDirectivo===m);return _?_.nombre_completo:""}},{data:null,render:function(m,r,b,w){return`<button class="editar-button" data-id="${b.idUnidad}" style="display: flex; justify-content: center;"><i class="fa fa-pencil"></i></button>`}}],c=S(!1),h=S(!1),U=S(!1),D=S(!1),k=V({_method:"DELETE"}),p=S([]);var f={};const d=m=>{f=m,D.value=!0},o=()=>{c.value=!1},s=()=>{h.value=!1},oe=()=>{U.value=!1},ie=()=>{D.value=!1},se=m=>{p.value.includes(m)?p.value=p.value.filter(b=>b!==m):p.value.push(m);const r=document.getElementById("eliminarABtn");p.value.length>0?r.removeAttribute("disabled"):r.setAttribute("disabled","")};re(()=>{document.getElementById("unidadesTablaId").addEventListener("click",m=>{const r=m.target;if(r.classList.contains("unidades-checkboxes")){const b=parseInt(r.getAttribute("data-id"));if(i.unidad){const w=i.unidad.find(_=>_.idUnidad===b);w?se(w):console.log("No se tiene unidad")}}}),$("#unidadesTablaId").on("click",".editar-button",function(){const m=$(this).data("id"),r=i.unidad.find(b=>b.idUnidad===m);d(r)})});const ne=()=>{const m=Y.mixin({buttonsStyling:!0}),r=p.value.map(b=>b.numeroUnidad).join(", ");m.fire({title:"¿Estas seguro que deseas eliminar la(s) unidad(es) seleccionada(s)?",html:`Unidades seleccionadas: ${r}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async b=>{if(b.isConfirmed)try{const _=p.value.map(F=>F.idUnidad).join(",");await k.post(route("servicio.eliminarUnidad",_)),p.value=[];const O=document.getElementById("eliminarABtn");p.value.length>0?O.removeAttribute("disabled"):O.setAttribute("disabled",""),Y.fire({title:"Unidad(es) eliminado(s) correctamente",icon:"success"}),window.flash={message:"Unidad(es) eliminado(s) correctamente",color:"green"}}catch(w){console.log("Error al eliminar varias unidades: "+w),Y.fire({title:"Error",text:"Hubo un error al eliminar las unidades. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(m,r)=>(g(),q(ce,{title:"Formar Unidades",usuario:i.usuario},{default:M(()=>[e("div",_d,[Ud,$d,wd,I(le),e("div",Sd,[e("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:r[0]||(r[0]=b=>c.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Od,x("Agregar Unidad ")]),e("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:ne},[Dd,x("Borrar Unidad ")]),e("button",{class:"bg-cyan-500 hover:bg-cyan-500 text-white font-semibold py-2 px-4 rounded",onClick:r[1]||(r[1]=b=>h.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[kd,x(" Asignar Operador ")]),e("button",{class:"bg-orange-500 hover:bg-orange-500 text-white font-semibold py-2 px-4 rounded",onClick:r[2]||(r[2]=b=>U.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Ed,x(" Quitar Operador ")])]),e("div",null,[I(n(X),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"unidadesTablaId",name:"unidadesTablaId",columns:l,data:a.unidad,options:{responsive:!0,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primero",previous:"Anterior",next:"Siguiente",last:"Ultimo"}},buttons:[t],pageLength:20}},{default:M(()=>[Cd]),_:1},8,["data","options"])])]),I(Ze,{show:c.value,"max-width":P,closeable:Q,onClose:o,title:"Añadir unidad",op:"1",modal:"modalCreate",unidad:i.unidad,ruta:i.ruta,operadoresDisp:i.operadoresDisp,directivo:i.directivo},null,8,["show","unidad","ruta","operadoresDisp","directivo"]),I(Mt,{show:D.value,"max-width":P,closeable:Q,onClose:ie,title:"Editar unidad",op:"2",modal:"modalEdit",unidad:n(f),ruta:i.ruta,operador:i.operador,operadoresDisp:i.operadoresDisp,directivo:i.directivo},null,8,["show","unidad","ruta","operador","operadoresDisp","directivo"]),I(sd,{show:h.value,"max-width":P,closeable:Q,onClose:s,title:"Asignar operador",op:"1",modal:"modalCreate",unidad:i.unidad,unidadesDisp:i.unidadesDisp,operadoresDisp:i.operadoresDisp},null,8,["show","unidad","unidadesDisp","operadoresDisp"]),I(yd,{show:U.value,"max-width":P,closeable:Q,onClose:oe,title:"Quitar operador",op:"1",modal:"modalCreate",unidad:i.unidad,unidadesConOperador:i.unidadesConOperador,operadoresDisp:i.operadoresDisp},null,8,["show","unidad","unidadesConOperador","operadoresDisp"])]),_:1},8,["usuario"]))}};export{Wd as default};
