import{r as A,K as D,o as i,h as l,y as u,b as r,t as f,j as y,z as S,u as g,L as $,F as b,i as B,n as _,k as C,I as V}from"./app-BR107gfA.js";import{S as x}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as h,w as K}from"./xlsx-DjuO7_Ju.js";import{E as L}from"./jspdf.plugin.autotable-gPIACCXF.js";const P={class:"text-lg font-bold"},Y={class:"flex flex-wrap gap-4 mb-3"},R={class:"flex flex-wrap space-x-3 mb-2"},U=["onUpdate:modelValue"],G=["value"],q={class:"flex flex-wrap space-x-3"},I=["onClick"],v=2024,X={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(M){const c=A([]),w=D({unidad:null,operador:null}),k=async a=>{const o=route("reporte.opSinTrabajar",{semana:a});try{const e=await V.get(o);c.value=Object.values(e.data)}catch(e){console.error("Error al obtener los datos:",e.response?e.response.data:e.message),x.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},j=async(a,o,e,t)=>{if(console.log("Semana seleccionada:",n),!n){x.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await k(n),a.titulo==="Operadores Sin Trabajar"&&(o==="pdf"?E(a.titulo,n):o==="excel"&&O(a.titulo,n))}catch{x.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},E=(a,o)=>{const e=new L("portrait");e.setFontSize(12),e.text(`Reporte de ${a} - Semana ${o}`,14,20),e.setFontSize(10),e.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const t=[{header:"Nombre del operador",dataKey:"nombre"}],s=c.value.map(m=>({nombre:m.nombre_completo||"N/A"}));e.autoTable({columns:t,body:s,startY:24,styles:{fontSize:10}});const d=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});e.setFontSize(10),e.text(`Fecha de creación: ${d}`,14,e.internal.pageSize.height-10);const p=`${a}-Semana-${o}.pdf`;e.save(p)},O=(a,o)=>{const e=`${a}-Semana-${o}.xlsx`,t=[["Nombre del Operador"]];c.value.forEach(p=>{const m=p.nombre_completo||"N/A";t.push([m])});const s=h.book_new(),d=h.aoa_to_sheet(t);h.book_append_sheet(s,d,"Operadores_Sin_Trabajar"),K(s,e)},F=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],T=Array.from({length:52},(a,o)=>o+1),N=new Date().getFullYear();Array.from({length:N-v+1},(a,o)=>v+o);let n=1;const z=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(a,o)=>(i(),l(b,null,u(z,e=>r("div",{key:e.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[r("h3",P,f(e.titulo),1),o[3]||(o[3]=r("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),r("div",Y,[r("div",R,[o[2]||(o[2]=r("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1)),y(r("select",{"onUpdate:modelValue":t=>e.periodoSeleccionado=t,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},o[1]||(o[1]=[r("option",{value:"semana"},"Semanal",-1)]),8,U),[[S,e.periodoSeleccionado]]),e.periodoSeleccionado==="semana"?y((i(),l("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=t=>$(n)?n.value=t:n=t),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(i(!0),l(b,null,u(g(T),(t,s)=>(i(),l("option",{key:s,value:t},"Semana "+f(t),9,G))),128))],512)),[[S,g(n)]]):B("",!0)])]),r("div",q,[(i(),l(b,null,u(F,t=>r("button",{key:t.tipo,class:_(t.clase),onClick:s=>j(e,t.tipo,w.operador,{tipo:e.periodoSeleccionado,valor:e.periodoSeleccionado==="semana"?g(n):""})},[r("i",{class:_(t.icono+" mr-2 jump-icon")},null,2),C(" "+f(t.texto),1)],10,I)),64))])])),64))}};export{X as _};
