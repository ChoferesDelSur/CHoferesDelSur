import{_ as F,a as P,b as z,c as K,d as V,e as G,f as H,g as I}from"./ReportesUltimasCorridas-Wvp24lQA.js";import{_ as J}from"./ServicioLayout-FzhawsM6.js";import{_ as Y}from"./ReporteOperadoresSinTrabajar-D0X4nrHT.js";import{K as q,r as Q,o as c,h as f,y as E,b as i,t as L,j as W,z as X,u as $,L as Z,F as O,n as j,k as aa,I as oa,a as ea,w as ra,d as l}from"./app-beN4cgxX.js";import{S as w}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as T,w as ta}from"./xlsx-DjuO7_Ju.js";import{E as na}from"./jspdf.plugin.autotable-DmQmR5MB.js";/* empty css                                                               */const da={class:"text-lg font-bold"},sa={class:"flex flex-wrap gap-4 mb-3"},ia={class:"flex flex-wrap space-x-3 mb-2"},la=["value"],ua={class:"flex flex-wrap space-x-3"},ca=["onClick"],pa={__name:"ReportesMultasDominicales",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(R){const a=q({unidad:null,operador:null});console.log("Estoy en componente ReportesMultasDominicales");const u=Q([]);let s=1;console.log("Semana seleccionada:",s);const k=[{titulo:"Multas Dominicales"}],C=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],p=r=>{if(!r)return"Sin registro";const[o,n]=r.split(":");return`${o}:${n}`},U=async r=>{const o=route("reporte.multasDominicales",{semana:r});console.log("Url:",o);try{console.log("Estoy despues del try");const n=await oa.get(o);u.value=Object.values(n.data),console.log(u.value)}catch(n){console.error("Error al obtener los datos:",n.response?n.response.data:n.message),w.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},N=async(r,o,n,d)=>{if(console.log("Estoy en generar archivo"),!s){w.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await U(s),r.titulo==="Multas Dominicales"&&(o==="pdf"?(console.log("Estoy en formato pdf"),y(r.titulo,s)):o==="excel"&&(console.log("Estoy en generarExcel"),D(r.titulo,s)))}catch{w.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},m=r=>r?`${r.apellidoP} ${r.apellidoM} ${r.nombre}`:"Sin registro",y=r=>{const o=new na("landscape");o.setFontSize(12),o.text(`Reporte de ${r}`,14,20);const n=u.value.map(e=>{const b=e.numeroUnidad||"N/A",t=e.directivo?`${e.directivo.nombre_completo}`:"N/A",g=e.entradaSabado?p(e.entradaSabado.horaEntrada):"Sin registro",S=e.entradaSabado?m(e.entradaSabado.operador):"Sin registro",_=e.entradaSabado&&e.entradaSabado.ruta?e.entradaSabado.ruta.nombreRuta:"Sin registro",x=e.entradaLunesTemprana?p(e.entradaLunesTemprana.horaEntrada):"Sin registro",h=e.entradaLunesTemprana?m(e.entradaLunesTemprana.operador):"Sin registro",v=e.entradaLunesTemprana&&e.entradaLunesTemprana.ruta?e.entradaLunesTemprana.ruta.nombreRuta:"Sin registro";return[b,t,g,S,_,x,h,v]}),d=[["Numero Unidad","Socio/Prestador","Sábado (horaEntrada)","Operador (Sábado)","Ruta (Sábado)","Lunes (horaEntrada)","Operador (Lunes)","Ruta (Lunes)"]];o.autoTable({head:d,body:n,startY:24}),o.save(`${r}.pdf`)},D=(r,o)=>{const n=`${r}-Semana-${o}.xlsx`,d=[["Numero Unidad","Socio/Prestador","Sábado (horaEntrada)","Operador (Sábado)","Ruta (Sábado)","Lunes (horaEntrada)","Operador (Lunes)","Ruta (Lunes)","Justificado"]];console.log("en generarExcel:",u.value),u.value.forEach(t=>{const g=t.numeroUnidad||"N/A",S=t.directivo?`${t.directivo.nombre_completo}`:"N/A",_=t.entradaSabado?p(t.entradaSabado.horaEntrada):"Sin registro",x=t.entradaSabado?m(t.entradaSabado.operador):"Sin registro",h=t.entradaSabado&&t.entradaSabado.ruta?t.entradaSabado.ruta.nombreRuta:"Sin registro",v=t.entradaLunesTemprana?p(t.entradaLunesTemprana.horaEntrada):"Sin registro",B=t.entradaLunesTemprana?m(t.entradaLunesTemprana.operador):"Sin registro",M=t.entradaLunesTemprana&&t.entradaLunesTemprana.ruta?t.entradaLunesTemprana.ruta.nombreRuta:"Sin registro";d.push([g,S,_,x,h,v,B,M,""])});const e=T.book_new(),b=T.aoa_to_sheet(d);T.book_append_sheet(e,b,"Reporte_Multas"),ta(e,n)},A=Array.from({length:52},(r,o)=>o+1);return(r,o)=>(c(),f(O,null,E(k,n=>i("div",{key:n.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[i("h3",da,L(n.titulo),1),o[2]||(o[2]=i("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),i("div",sa,[i("div",ia,[o[1]||(o[1]=i("h2",{class:"font-semibold text-l pt-0"},"Semana: ",-1)),W(i("select",{"onUpdate:modelValue":o[0]||(o[0]=d=>Z(s)?s.value=d:s=d),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 p-2"},[(c(!0),f(O,null,E($(A),d=>(c(),f("option",{key:d,value:d},"Semana "+L(d),9,la))),128))],512),[[X,$(s)]])])]),i("div",ua,[(c(),f(O,null,E(C,d=>i("button",{key:d.tipo,class:j(d.clase),onClick:e=>N(n,d.tipo,a.unidad,{tipo:n.periodoSeleccionado,valor:n.periodoSeleccionado==="semana"?$(s):""})},[i("i",{class:j(d.icono+" mr-2 jump-icon")},null,2),aa(" "+L(d.texto),1)],10,ca)),64))])])),64))}},ma={class:"mt-1 bg-white p-4 shadow rounded-lg h-5/6"},Ea={__name:"Reportes",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},tipoUltimaCorrida:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})},ultimaCorrida:{type:Object,default:()=>({})},castigo:{type:Object,default:()=>({})}},setup(R){const a=R;return(u,s)=>(c(),ea(J,{title:"Reportes",usuario:a.usuario},{default:ra(()=>[i("div",ma,[s[0]||(s[0]=i("h2",{class:"font-bold text-center text-xl pt-0 mb-2"},"Reportes",-1)),s[1]||(s[1]=i("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-2"},null,-1)),l(F,{unidad:a.unidad,operador:a.operador,entrada:a.entrada},null,8,["unidad","operador","entrada"]),l(P,{unidad:a.unidad,operador:a.operador,entrada:a.entrada},null,8,["unidad","operador","entrada"]),l(z,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),l(K,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),l(V,{unidad:a.unidad,operador:a.operador,corte:a.corte},null,8,["unidad","operador","corte"]),l(G,{unidad:a.unidad,operador:a.operador,tipoUltimaCorrida:a.tipoUltimaCorrida,ultimaCorrida:a.ultimaCorrida},null,8,["unidad","operador","tipoUltimaCorrida","ultimaCorrida"]),l(H,{unidad:a.unidad,operador:a.operador,castigo:a.castigo},null,8,["unidad","operador","castigo"]),l(I,{unidad:a.unidad,operador:a.operador},null,8,["unidad","operador"]),l(Y,{unidad:a.unidad,operador:a.operador},null,8,["unidad","operador"]),l(pa,{unidad:a.unidad,entrada:a.entrada,corte:a.corte,operador:a.operador},null,8,["unidad","entrada","corte","operador"])])]),_:1},8,["usuario"]))}};export{Ea as default};
