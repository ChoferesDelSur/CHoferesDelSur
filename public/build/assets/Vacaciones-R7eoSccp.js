import{u as L,r as x,i as U,o as h,j as R,e as A,a as e,g as z,t as w,w as k,d as m,k as I,c as D,F as W,m as H,p as Y,l as S,f as p,L as P,D as C,s as q,b as B,x as O}from"./app-lPkL4NWi.js";import"./buttons.print-BP8DLS4z.js";import{S as j}from"./sweetalert2.all-DNnYxgkN.js";import{_ as G}from"./Mensaje-NoNka-KO.js";import{_ as X}from"./RHLayout-CGgkmvwz.js";import{_ as J}from"./Modal-CsZeSjS-.js";import{E as K}from"./jspdf.plugin.autotable-C_z00sXI.js";import{u as M,w as Q}from"./xlsx-769MyM77.js";/* empty css                                                */const Z={class:"mt-2 bg-white p-4 shadow rounded-lg"},ee={class:"border-b border-gray-900/10 pb-12"},te={class:"text-base font-semibold leading-7 text-gray-900"},oe=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},[p("Rellene el formulario para poder registrar las vacaciones. Los campos con "),e("span",{class:"text-red-500"},"*"),p(" son obligatorios. ")],-1),se={class:"flex flex-wrap -mx-4"},ae={class:"sm:col-span-2"},ie={class:"sm:col-span-1",hidden:""},ne=e("label",{for:"idVacaciones",class:"block text-sm font-medium leading-6 text-gray-900"},"idVacaciones",-1),re={class:"mt-2"},ce=["id"],le={class:"sm:col-span-2 px-4"},de=e("label",{for:"personal",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Personal "),e("span",{class:"text-red-500"},"*")],-1),me={class:"mt-2"},ue=["id"],pe=e("option",{value:"",disabled:"",selected:""},"Seleccione al personal",-1),ge=["value"],fe={key:0,class:"text-red-500 text-xs mt-1"},he={class:"md:col-span-2 px-2"},be=e("label",{for:"motivo",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Motivo "),e("span",{class:"text-red-500"},"*")],-1),xe={class:"mt-2"},ve=["id"],ye={key:0,class:"text-red-500 text-xs mt-1"},_e={class:"sm:col-span-2 px-2"},we=e("label",{for:"numDias",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Número de Días "),e("span",{class:"text-red-500"},"*")],-1),De={class:"mt-2"},ke=["id"],Fe={key:0,class:"text-red-500 text-xs mt-1"},Ie={class:"sm:col-span-2 px-4"},Se=e("label",{for:"fechaInicio",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Fecha Inicio "),e("span",{class:"text-red-500"},"*")],-1),Ve={class:"mt-2"},Ee=["id"],$e={key:0,class:"text-red-500 text-xs mt-1"},Te={class:"sm:col-span-2 px-4"},Ne=e("label",{for:"fechaFin",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Fecha Fin "),e("span",{class:"text-red-500"},"*")],-1),Pe={class:"mt-2"},Be=["id"],je={key:0,class:"text-red-500 text-xs mt-1"},Me={class:"mt-6 flex items-center justify-end gap-x-6"},Ae=["id"],Ce=e("i",{class:"fa-solid fa-ban"},null,-1),Oe=["disabled"],Le=e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Re={__name:"FormularioVacaciones",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},personal:{type:Object,default:()=>({})},vacaciones:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(l,{emit:u}){const b=l,E=u,a=L({idVacaciones:b.vacaciones.idVacaciones,motivo:b.vacaciones.motivo,numeroDias:b.vacaciones.numeroDias,fechaInicio:b.vacaciones.fechaInicio,fechaFin:b.vacaciones.fechaFin,persona:b.vacaciones.idPersonal}),v=x(""),f=x(""),d=x(""),y=x(""),_=x(""),F=async()=>{E("close"),a.reset()};U([()=>a.numeroDias,()=>a.fechaInicio],([t,o])=>{if(t>0&&o){const s=new Date(o);s.setDate(s.getDate()+parseInt(t));const g=s.getFullYear(),V=String(s.getMonth()+1).padStart(2,"0"),N=String(s.getDate()).padStart(2,"0");a.fechaFin=`${g}-${V}-${N}`}},{immediate:!0});const T=t=>t!=null,n=t=>!(t==null||((typeof t=="string"||t instanceof String)&&(t=new Date(t)),!(t instanceof Date))||isNaN(t.getTime())),i=t=>typeof t=="string"&&t.trim()!=="",r=t=>t==null?!1:Number.isInteger(t)&&t>=0,c=async()=>{_.value=T(a.persona)?"":"Seleccione al personal",v.value=i(a.motivo)?"":"Ingrese el motivo",f.value=r(a.numeroDias)?"":"Número de días no válido",d.value=n(a.fechaInicio)?"":"Fecha de inicio no válido",y.value=n(a.fechaFin)?"":"Fecha de fin no válido",!(_.value||v.value||f.value||d.value||y.value)&&a.post(route("rh.addVacaciones"),{onSuccess:()=>{F(),_.value="",v.value="",f.value="",d.value="",y.value=""}})};return(t,o)=>(h(),R(J,{show:l.show,"max-width":l.maxWidth,closeable:l.closeable,onClose:F},{default:A(()=>[e("div",Z,[e("form",{onSubmit:z(c,["prevent"])},[e("div",ee,[e("h2",te,w(l.title),1),oe,e("div",se,[e("div",ae,[e("div",ie,[ne,e("div",re,[k(e("input",{type:"number",name:"idVacaciones","onUpdate:modelValue":o[0]||(o[0]=s=>m(a).idVacaciones=s),placeholder:"Ingrese id de vacaciones",id:"idVacaciones"+l.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ce),[[I,m(a).idVacaciones]])])])]),e("div",le,[de,e("div",me,[k(e("select",{name:"personal",id:"personal"+l.op,"onUpdate:modelValue":o[1]||(o[1]=s=>m(a).persona=s),placeholder:"Seleccione al personal",class:"block w-54 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[pe,(h(!0),D(W,null,H(l.personal,s=>(h(),D("option",{key:s.idPersonal,value:s.idPersonal},w(s.nombre_completo),9,ge))),128))],8,ue),[[Y,m(a).persona]])]),_.value!=""?(h(),D("div",fe,w(_.value),1)):S("",!0)]),e("div",he,[be,e("div",xe,[k(e("input",{type:"text",name:"motivo",id:"motivo"+l.op,"onUpdate:modelValue":o[2]||(o[2]=s=>m(a).motivo=s),placeholder:"Ingrese el motivo",class:"block w-72 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ve),[[I,m(a).motivo]])]),v.value!=""?(h(),D("div",ye,w(v.value),1)):S("",!0)]),e("div",_e,[we,e("div",De,[k(e("input",{type:"number",name:"numDias",id:"numDias"+l.op,"onUpdate:modelValue":o[3]||(o[3]=s=>m(a).numeroDias=s),placeholder:" ",class:"block w-28 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ke),[[I,m(a).numeroDias]])]),f.value!=""?(h(),D("div",Fe,w(f.value),1)):S("",!0)]),e("div",Ie,[Se,e("div",Ve,[k(e("input",{type:"date",name:"fechaInicio",id:"fechaInicio"+l.op,"onUpdate:modelValue":o[4]||(o[4]=s=>m(a).fechaInicio=s),placeholder:"Ingrese la fecha de inicio",class:"block w-44 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Ee),[[I,m(a).fechaInicio]])]),d.value!=""?(h(),D("div",$e,w(d.value),1)):S("",!0)]),e("div",Te,[Ne,e("div",Pe,[k(e("input",{type:"date",name:"fechaFin",id:"fechaFin"+l.op,"onUpdate:modelValue":o[5]||(o[5]=s=>m(a).fechaFin=s),placeholder:"Ingrese la fecha de fin",class:"block w-44 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Be),[[I,m(a).fechaFin]])]),y.value!=""?(h(),D("div",je,w(y.value),1)):S("",!0)])])]),e("div",Me,[e("button",{type:"button",id:"cerrar"+l.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:F},[Ce,p(" Cancelar")],8,Ae),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",disabled:m(a).processing},[Le,p("Guardar")],8,Oe)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Ue={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},ze=e("h2",{class:"font-bold text-center text-xl pt-0"},"Vacaciones",-1),We=e("div",{class:"my-1"},null,-1),He=e("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1),Ye={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},qe=e("i",{class:"fa fa-plus mr-2"},null,-1),Ge=e("i",{class:"fa fa-trash mr-2"},null,-1),Xe={class:"overflow-x-auto"},Je=e("thead",null,[e("tr",{class:"text-sm leading-normal"},[e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Personal Administrativo "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Motivo "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Número de Días "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Fecha de Inicio "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Fecha de Fin ")])],-1),Ke="xl",Qe=!0,ct={__name:"Vacaciones",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},personal:{type:Object},vacaciones:{type:Object}},setup(l){P.use(C),P.use(C);const u=l,b=(n="Documento")=>{const i=new K("landscape");i.setFontSize(12),i.text(n,14,22);const r=new Date().toLocaleDateString();i.setFontSize(8),i.text(`Fecha: ${r}`,260,22);const c=["ID","Personal Administrativo","Motivo","Número De Días","Fecha De Inicio","Fecha De Fín"],t=[];O(()=>{$("#vacacionesTablaId").DataTable().rows({search:"applied"}).data().each(g=>{var V;t.push([g.idVacaciones,((V=u.personal.find(N=>N.idPersonal===g.idPersonal))==null?void 0:V.nombre_completo)||"",g.motivo,g.numeroDias,g.fechaInicio,g.fechaFin])}),i.autoTable({head:[c],body:t,startY:24}),i.save(`${n}.pdf`)})},E=()=>{O(()=>{const r=$("#vacacionesTablaId").DataTable().rows({search:"applied"}).data().toArray().map(o=>{var s;return{ID:o.idVacaciones,"Personal administrativo":((s=u.personal.find(g=>g.idPersonal===o.idPersonal))==null?void 0:s.nombre_completo)||"",Motivo:o.motivo,"Número de Días":o.numeroDias,"Fecha De Inicio":o.fechaInicio,"Fecha De Fin":o.fechaFin}}),c=M.json_to_sheet(r),t=M.book_new();M.book_append_sheet(t,c,"Directivos Registrados"),Q(t,"Directivos Registrados.xlsx")})},a=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2,3,4,5,6]},button:!0},{title:"Movimientos registrados",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>E()},{title:"Movimientos registrados",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",orientation:"landscape",action:()=>b(u.title||"Vacaciones Registrados")},{title:"Operadores registrados",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[1,2,3,4,5,6]}}],v=[{data:null,render:function(n,i,r,c){return`<input type="checkbox" class="vacaciones-checkboxes" data-id="${r.idVacaciones}" ">`}},{data:null,render:function(n,i,r,c){return c.row+1}},{data:"idPersonal",render:function(n,i,r,c){const t=u.personal.find(o=>o.idPersonal===n);return t?t.nombre_completo:""}},{data:"motivo"},{data:"numeroDias"},{data:"fechaInicio"},{data:"fechaFin"}],f=x(!1);x(!1);const d=x([]),y=L({_method:"DELETE"}),_=()=>{f.value=!1},F=n=>{d.value.includes(n)?d.value=d.value.filter(r=>r!==n):d.value.push(n);const i=document.getElementById("eliminarABtn");d.value.length>0?i.removeAttribute("disabled"):i.setAttribute("disabled","")};q(()=>{document.getElementById("vacacionesTablaId").addEventListener("click",n=>{const i=n.target;if(i.classList.contains("vacaciones-checkboxes")){const r=parseInt(i.getAttribute("data-id"));if(u.vacaciones){const c=u.vacaciones.find(t=>t.idVacaciones===r);c?F(c):console.log("No se tiene movimiento")}}})});const T=()=>{const n=j.mixin({buttonsStyling:!0}),i=d.value.map(r=>{const c=u.personal.find(t=>t.idPersonal===r.idPersonal);return`${c?c.nombre_completo:"Desconocido"}`}).join("<br>");n.fire({title:"¿Estas seguro que deseas eliminar las vacaciones del personal seleccionado?",html:`Vacaciones seleccionado:<br>${i}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async r=>{if(r.isConfirmed)try{const t=d.value.map(s=>s.idVacaciones).join(",");await y.post(route("rh.eliminarVacaciones",t)),d.value=[];const o=document.getElementById("eliminarABtn");d.value.length>0?o.removeAttribute("disabled"):o.setAttribute("disabled",""),j.fire({title:"Vacaciones eliminado(s) correctamente",icon:"success"}),window.flash={message:"Vacaciones eliminado(s) correctamente",color:"green"}}catch(c){console.log("Error al eliminar varias vacaciones: "+c),j.fire({title:"Error",text:"Hubo un error al eliminar el movimiento. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(n,i)=>(h(),R(X,{title:"Vacaciones",usuario:u.usuario},{default:A(()=>[e("div",Ue,[ze,We,He,B(G),e("div",Ye,[e("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:i[0]||(i[0]=r=>f.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[qe,p("Registrar Vacaciones ")]),e("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:T},[Ge,p(" Eliminar Vacaciones ")])]),e("div",Xe,[B(m(P),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"vacacionesTablaId",name:"vacacionesTablaId",columns:v,data:l.vacaciones,options:{responsive:!1,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)"},buttons:[a],paging:!1}},{default:A(()=>[Je]),_:1},8,["data","options"])])]),B(Re,{show:f.value,"max-width":Ke,closeable:Qe,onClose:_,title:"Añadir Vacaciones",modal:"modalCreate",personal:u.personal,vacaciones:u.vacaciones},null,8,["show","personal","vacaciones"])]),_:1},8,["usuario"]))}};export{ct as default};
