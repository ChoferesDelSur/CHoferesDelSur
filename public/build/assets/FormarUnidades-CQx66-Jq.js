import{L as y,D as I,q as N,o as B,j as z,e as E,a as n,b as P,t as V,d as f,x as G}from"./app-BSIMybGi.js";import"./buttons.print-B0VA6oqR.js";/* empty css                                                */import"./jspdf.plugin.autotable-B6gQuQY9.js";import{u as m,w as q}from"./xlsx-769MyM77.js";import{_ as J}from"./RHLayout-C_wb1aw5.js";const W={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},X=n("h2",{class:"font-bold text-center text-xl pt-0"}," Formar Unidades",-1),K=n("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-1.5"},null,-1),Q={class:"overflow-x-auto"},Y={class:"text-sm leading-normal border-b border-gray-300"},Z=n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1),ee={class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"2"},te=n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1),re=n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1),de=n("th",{class:"py-2 px-4 bg-green-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300 text-left",colspan:"3"},"ENTRADA",-1),oe=n("th",{class:"py-2 px-4 bg-red-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"3"},"CORTE",-1),ae=n("th",{class:"py-2 px-4 bg-blue-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"3"},"ÚLTIMAS CORRIDAS",-1),ne=n("th",{class:"py-2 px-4 bg-yellow-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300",colspan:"4"},"CASTIGO",-1),ie=n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"},null,-1),se=n("tr",{class:"text-sm leading-normal border-b border-gray-300"},[n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," ID "),n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Ruta "),n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Trab. DOMINGO "),n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Unidad "),n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Socio / Prestador "),n("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. entrada "),n("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Tipo entrada "),n("th",{class:"py-2 px-4 bg-green-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Extremo "),n("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. Corte "),n("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Causa "),n("th",{class:"py-2 px-4 bg-red-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. regreso "),n("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Tipo de Corrida "),n("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. inicio "),n("th",{class:"py-2 px-4 bg-blue-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. regreso "),n("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. inicio "),n("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Hr. finaliza "),n("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Motivo "),n("th",{class:"py-2 px-4 bg-yellow-100 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Otras observaciones "),n("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-600 border-r border-grey-300"}," Operador ")],-1),ye={__name:"FormarUnidades",props:{message:{String,default:""},color:{String,default:""},ruta:{type:Object},unidad:{type:Object},unidadesConOperador:{type:Object},operador:{type:Object},directivo:{type:Object},rolServicio:{type:Object},castigo:{type:Object},entrada:{type:Object},corte:{type:Object},ultimaCorrida:{type:Object},tipoUltimaCorrida:{type:Object},usuario:{type:Object}},setup(x){y.use(I),y.use(I);const d=x,p=new Date().toLocaleDateString(),F=L(new Date().getDay());function L(o){return["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"][o]}N(()=>d.entrada.filter(o=>new Date(o.fechaRegistro).toLocaleDateString()===p));const k=()=>{G(()=>{const c=$("#formacionTablaId").DataTable().rows({search:"applied"}).data(),s=t=>{if(!t)return"";const[a,b]=t.split(":");return`${a}:${b}`},l=c.toArray().map(t=>{var u,g,h,U,_,D,v,w,S,C,R,j,H,O,T;const a=d.ultimaCorrida.find(i=>i.idUnidad===t.idUnidad),b=d.tipoUltimaCorrida.find(i=>i.idTipoUltimaCorrida===(a==null?void 0:a.idTipoUltimaCorrida));return{ID:t.idUnidad,Ruta:(u=d.ruta.find(i=>i.idRuta===t.idRuta))==null?void 0:u.nombreRuta,"Trab. Domingo":(g=d.rolServicio.find(i=>i.idRolServicio===t.idUnidad))==null?void 0:g.trabajaDomingo,Unidad:(h=d.unidad.find(i=>i.idUnidad===t.idUnidad))==null?void 0:h.numeroUnidad,"Socio/Prestador":((U=d.directivo.find(i=>i.idDirectivo===t.idDirectivo))==null?void 0:U.nombre_completo)||"","Hr. Entrada":s((_=d.entrada.find(i=>i.idUnidad===t.idUnidad))==null?void 0:_.horaEntrada),"Tipo Entrada":(D=d.entrada.find(i=>i.idUnidad===t.idUnidad))==null?void 0:D.tipoEntrada,Extremo:(v=d.entrada.find(i=>i.idUnidad===t.idUnidad))==null?void 0:v.extremo,"Hr. Corte":s((w=d.corte.find(i=>i.idUnidad===t.idUnidad))==null?void 0:w.horaCorte),Causa:(S=d.corte.find(i=>i.idUnidad===t.idUnidad))==null?void 0:S.causa,"Hr. Regreso":s((C=d.corte.find(i=>i.idUnidad===t.idUnidad))==null?void 0:C.horaRegreso),"Tipo De Corrida":b==null?void 0:b.tipoUltimaCorrida,"Hr. Inicio UC":s(a==null?void 0:a.horaInicioUC),"Hr. Regreso UC":s(a==null?void 0:a.horaFinUC),"Hr. Inicio":s((R=d.castigo.find(i=>i.idUnidad===t.idUnidad))==null?void 0:R.horaInicio),"Hr. Finaliza":s((j=d.castigo.find(i=>i.idUnidad===t.idUnidad))==null?void 0:j.horaFin),Motivo:(H=d.castigo.find(i=>i.idUnidad===t.idUnidad))==null?void 0:H.castigo,"Otras Observaciones":(O=d.castigo.find(i=>i.idUnidad===t.idUnidad))==null?void 0:O.observaciones,Operador:(T=d.operador.find(i=>i.idOperador===t.idOperador))==null?void 0:T.nombre_completo}}),r=m.json_to_sheet(l),e=m.book_new();m.book_append_sheet(e,r,"Formación De Unidades"),q(e,"Formación De Unidades.xlsx")})},A=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2]},button:!0},{title:"Formación De Unidades",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>k()},{title:"Formación De Unidades",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]}}],M=[{data:null,render:function(o,c,s,l){return l.row+1}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.ruta.find(t=>t.idRuta===r.idRuta);return e?e.nombreRuta:""}else return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.rolServicio.filter(t=>t.idUnidad===r.idUnidad);return e.length>0?(e.sort((t,a)=>new Date(a.created_at)-new Date(t.created_at)),e[0].trabajaDomingo):'<span style="color: red;">Sin asignar</span>'}else return"Unidad no encontrada"}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);return r?r.numeroUnidad:""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.directivo.find(t=>t.idDirectivo===r.idDirectivo);return e?e.nombre_completo:""}else return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.entrada.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map(a=>a.horaEntrada.substring(0,5)).join(", ")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.entrada.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map(a=>a.tipoEntrada).join(", ")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.entrada.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map(a=>a.extremo).join(", ")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map((a,b)=>`
            <div style="${e.length>1&&b!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${a.horaCorte.substring(0,5)}</div>
            </div>
          `).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map((a,b)=>`
            <div style="${e.length>1&&b!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${a.causa}</div>
            </div>
          `).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.corte.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0)return e.map((a,b)=>{const u=a.horaRegreso?a.horaRegreso.substring(0,5):"";return`
            <div style="${e.length>1&&b!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
              <div>${u}</div>
            </div>
          `}).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0){const t=d.tipoUltimaCorrida.find(a=>a.idTipoUltimaCorrida===e[0].idTipoUltimaCorrida);if(t)return t.tipoUltimaCorrida}}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0){const t=e[0].horaInicioUC;return t?t.substring(0,5):""}}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.ultimaCorrida.filter(t=>t.idUnidad===r.idUnidad&&new Date(t.created_at).toLocaleDateString()===p);if(e.length>0){const t=e[0].horaFinUC;if(t)return t.substring(0,5)}}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.castigo.filter(e=>e.idUnidad===o&&new Date(e.created_at).toLocaleDateString()===p);if(r.length>0){const e=r.map(t=>({horaInicio:t.horaInicio?t.horaInicio.substring(0,5):""}));return e.map((t,a)=>`
          <div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
            <div>${t.horaInicio}</div>
          </div>
        `).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.castigo.filter(e=>e.idUnidad===o&&new Date(e.created_at).toLocaleDateString()===p);if(r.length>0){const e=r.map(t=>({horaFin:t.horaFin?t.horaFin.substring(0,5):""}));return e.map((t,a)=>`
          <div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">
            <div>${t.horaFin}</div>
          </div>
        `).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.castigo.filter(e=>e.idUnidad===o&&new Date(e.created_at).toLocaleDateString()===p);if(r.length>0){const e=r.map(t=>t.castigo||"");return e.map((t,a)=>`<div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">${t}</div>`).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.castigo.filter(e=>e.idUnidad===o&&new Date(e.created_at).toLocaleDateString()===p);if(r.length>0){const e=r.map(t=>t.observaciones||"");return e.map((t,a)=>`<div style="${e.length>1&&a!==e.length-1?"border-bottom: 1px solid #b2b2b2;":""}">${t}</div>`).join("")}return""}},{data:"idUnidad",render:function(o,c,s,l){const r=d.unidad.find(e=>e.idUnidad===o);if(r){const e=d.operador.find(t=>t.idOperador===r.idOperador);return e?e.nombre_completo:'<span style="color: red;">Sin asignar</span>'}else return""}}];return(o,c)=>(B(),z(J,{title:"Formar Unidades",usuario:d.usuario},{default:E(()=>[n("div",W,[X,K,n("div",Q,[P(f(y),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"formacionTablaId",name:"formacionTablaId",columns:M,data:x.unidad,options:{responsive:!1,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)"},buttons:[A],paging:!1,lengthMenu:[]}},{default:E(()=>[n("thead",null,[n("tr",Y,[Z,n("th",ee,"FECHA: "+V(f(F)+", "+f(p)),1),te,re,de,oe,ae,ne,ie]),se])]),_:1},8,["data","options"])])])]),_:1},8,["usuario"]))}};export{ye as default};
