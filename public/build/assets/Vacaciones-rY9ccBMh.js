import{e as L,r as v,x as U,o as b,a as R,w as C,b as e,g as z,t as D,k as p,j as _,u as m,v as I,h as k,F as W,y as H,z as Y,i as S,C as P,D as M,f as q,d as B,A as O}from"./app-BbX4xmX9.js";import"./buttons.print-Dbq9ZlOJ.js";import{S as j}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{_ as G}from"./Mensaje-BhVK3LmL.js";import{_ as X}from"./RHLayout-YJVQURx-.js";import{_ as J}from"./Modal-BRl-OegU.js";import{E as K}from"./jspdf.plugin.autotable-CidKmSnM.js";import{u as A,w as Q}from"./xlsx-DjuO7_Ju.js";/* empty css                                                */const Z={class:"mt-2 bg-white p-4 shadow rounded-lg"},ee={class:"border-b border-gray-900/10 pb-12"},te={class:"text-base font-semibold leading-7 text-gray-900"},oe={class:"flex flex-wrap -mx-4"},se={class:"sm:col-span-2"},ae={class:"sm:col-span-1",hidden:""},ie={class:"mt-2"},ne=["id"],re={class:"sm:col-span-2 px-4"},le={class:"mt-2"},ce=["id"],de=["value"],me={key:0,class:"text-red-500 text-xs mt-1"},ue={class:"md:col-span-2 px-2"},pe={class:"mt-2"},ge=["id"],fe={key:0,class:"text-red-500 text-xs mt-1"},be={class:"sm:col-span-2 px-2"},xe={class:"mt-2"},ve=["id"],he={key:0,class:"text-red-500 text-xs mt-1"},ye={class:"sm:col-span-2 px-4"},we={class:"mt-2"},De=["id"],ke={key:0,class:"text-red-500 text-xs mt-1"},_e={class:"sm:col-span-2 px-4"},Fe={class:"mt-2"},Ie=["id"],Se={key:0,class:"text-red-500 text-xs mt-1"},Ve={class:"mt-6 flex items-center justify-end gap-x-6"},Ee=["id"],Te=["disabled"],Ne={__name:"FormularioVacaciones",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},personal:{type:Object,default:()=>({})},vacaciones:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(c,{emit:u}){const x=c,E=u,i=L({idVacaciones:x.vacaciones.idVacaciones,motivo:x.vacaciones.motivo,numeroDias:x.vacaciones.numeroDias,fechaInicio:x.vacaciones.fechaInicio,fechaFin:x.vacaciones.fechaFin,persona:x.vacaciones.idPersonal}),h=v(""),f=v(""),d=v(""),y=v(""),w=v(""),F=async()=>{E("close"),i.reset()};U([()=>i.numeroDias,()=>i.fechaInicio],([o,t])=>{if(o>0&&t){const a=new Date(t);a.setDate(a.getDate()+parseInt(o));const g=a.getFullYear(),V=String(a.getMonth()+1).padStart(2,"0"),N=String(a.getDate()).padStart(2,"0");i.fechaFin=`${g}-${V}-${N}`}},{immediate:!0});const T=o=>o!=null,n=o=>!(o==null||((typeof o=="string"||o instanceof String)&&(o=new Date(o)),!(o instanceof Date))||isNaN(o.getTime())),s=o=>typeof o=="string"&&o.trim()!=="",r=o=>o==null?!1:Number.isInteger(o)&&o>=0,l=async()=>{w.value=T(i.persona)?"":"Seleccione al personal",h.value=s(i.motivo)?"":"Ingrese el motivo",f.value=r(i.numeroDias)?"":"Número de días no válido",d.value=n(i.fechaInicio)?"":"Fecha de inicio no válido",y.value=n(i.fechaFin)?"":"Fecha de fin no válido",!(w.value||h.value||f.value||d.value||y.value)&&i.post(route("rh.addVacaciones"),{onSuccess:()=>{F(),w.value="",h.value="",f.value="",d.value="",y.value=""}})};return(o,t)=>(b(),R(J,{show:c.show,"max-width":c.maxWidth,closeable:c.closeable,onClose:F},{default:C(()=>[e("div",Z,[e("form",{onSubmit:z(l,["prevent"])},[e("div",ee,[e("h2",te,D(c.title),1),t[13]||(t[13]=e("p",{class:"mt-1 text-sm leading-6 text-gray-600 mb-4"},[p("Rellene el formulario para poder registrar las vacaciones. Los campos con "),e("span",{class:"text-red-500"},"*"),p(" son obligatorios. ")],-1)),e("div",oe,[e("div",se,[e("div",ae,[t[6]||(t[6]=e("label",{for:"idVacaciones",class:"block text-sm font-medium leading-6 text-gray-900"},"idVacaciones",-1)),e("div",ie,[_(e("input",{type:"number",name:"idVacaciones","onUpdate:modelValue":t[0]||(t[0]=a=>m(i).idVacaciones=a),placeholder:"Ingrese id de vacaciones",id:"idVacaciones"+c.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ne),[[I,m(i).idVacaciones]])])])]),e("div",re,[t[8]||(t[8]=e("label",{for:"personal",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Personal "),e("span",{class:"text-red-500"},"*")],-1)),e("div",le,[_(e("select",{name:"personal",id:"personal"+c.op,"onUpdate:modelValue":t[1]||(t[1]=a=>m(i).persona=a),placeholder:"Seleccione al personal",class:"block w-54 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[t[7]||(t[7]=e("option",{value:"",disabled:"",selected:""},"Seleccione al personal",-1)),(b(!0),k(W,null,H(c.personal,a=>(b(),k("option",{key:a.idPersonal,value:a.idPersonal},D(a.nombre_completo),9,de))),128))],8,ce),[[Y,m(i).persona]])]),w.value!=""?(b(),k("div",me,D(w.value),1)):S("",!0)]),e("div",ue,[t[9]||(t[9]=e("label",{for:"motivo",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Motivo "),e("span",{class:"text-red-500"},"*")],-1)),e("div",pe,[_(e("input",{type:"text",name:"motivo",id:"motivo"+c.op,"onUpdate:modelValue":t[2]||(t[2]=a=>m(i).motivo=a),placeholder:"Ingrese el motivo",class:"block w-72 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ge),[[I,m(i).motivo]])]),h.value!=""?(b(),k("div",fe,D(h.value),1)):S("",!0)]),e("div",be,[t[10]||(t[10]=e("label",{for:"numDias",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Número de Días "),e("span",{class:"text-red-500"},"*")],-1)),e("div",xe,[_(e("input",{type:"number",name:"numDias",id:"numDias"+c.op,"onUpdate:modelValue":t[3]||(t[3]=a=>m(i).numeroDias=a),placeholder:" ",class:"block w-28 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,ve),[[I,m(i).numeroDias]])]),f.value!=""?(b(),k("div",he,D(f.value),1)):S("",!0)]),e("div",ye,[t[11]||(t[11]=e("label",{for:"fechaInicio",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Fecha Inicio "),e("span",{class:"text-red-500"},"*")],-1)),e("div",we,[_(e("input",{type:"date",name:"fechaInicio",id:"fechaInicio"+c.op,"onUpdate:modelValue":t[4]||(t[4]=a=>m(i).fechaInicio=a),placeholder:"Ingrese la fecha de inicio",class:"block w-44 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,De),[[I,m(i).fechaInicio]])]),d.value!=""?(b(),k("div",ke,D(d.value),1)):S("",!0)]),e("div",_e,[t[12]||(t[12]=e("label",{for:"fechaFin",class:"block text-sm font-medium leading-6 text-gray-900"},[p("Fecha Fin "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Fe,[_(e("input",{type:"date",name:"fechaFin",id:"fechaFin"+c.op,"onUpdate:modelValue":t[5]||(t[5]=a=>m(i).fechaFin=a),placeholder:"Ingrese la fecha de fin",class:"block w-44 rounded-md border-0 px-1.5 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Ie),[[I,m(i).fechaFin]])]),y.value!=""?(b(),k("div",Se,D(y.value),1)):S("",!0)])])]),e("div",Ve,[e("button",{type:"button",id:"cerrar"+c.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:F},t[14]||(t[14]=[e("i",{class:"fa-solid fa-ban"},null,-1),p(" Cancelar")]),8,Ee),e("button",{type:"submit",class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",disabled:m(i).processing},t[15]||(t[15]=[e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),p("Guardar")]),8,Te)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Pe={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},$e={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},Be={class:"overflow-x-auto"},je="xl",Ae=!0,Ye={__name:"Vacaciones",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},personal:{type:Object},vacaciones:{type:Object}},setup(c){P.use(M),P.use(M);const u=c,x=(n="Documento")=>{const s=new K("landscape");s.setFontSize(12),s.text(n,14,22);const r=new Date().toLocaleDateString();s.setFontSize(8),s.text(`Fecha: ${r}`,260,22);const l=["ID","Personal Administrativo","Motivo","Número De Días","Fecha De Inicio","Fecha De Fín"],o=[];O(()=>{$("#vacacionesTablaId").DataTable().rows({search:"applied"}).data().each(g=>{var V;o.push([g.idVacaciones,((V=u.personal.find(N=>N.idPersonal===g.idPersonal))==null?void 0:V.nombre_completo)||"",g.motivo,g.numeroDias,g.fechaInicio,g.fechaFin])}),s.autoTable({head:[l],body:o,startY:24}),s.save(`${n}.pdf`)})},E=()=>{O(()=>{const r=$("#vacacionesTablaId").DataTable().rows({search:"applied"}).data().toArray().map(t=>{var a;return{ID:t.idVacaciones,"Personal administrativo":((a=u.personal.find(g=>g.idPersonal===t.idPersonal))==null?void 0:a.nombre_completo)||"",Motivo:t.motivo,"Número de Días":t.numeroDias,"Fecha De Inicio":t.fechaInicio,"Fecha De Fin":t.fechaFin}}),l=A.json_to_sheet(r),o=A.book_new();A.book_append_sheet(o,l,"Directivos Registrados"),Q(o,"Directivos Registrados.xlsx")})},i=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2,3,4,5,6]},button:!0},{title:"Movimientos registrados",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>E()},{title:"Movimientos registrados",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",orientation:"landscape",action:()=>x(u.title||"Vacaciones Registrados")},{title:"Operadores registrados",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[1,2,3,4,5,6]}}],h=[{data:null,render:function(n,s,r,l){return`<input type="checkbox" class="vacaciones-checkboxes" data-id="${r.idVacaciones}" ">`}},{data:null,render:function(n,s,r,l){return l.row+1}},{data:"idPersonal",render:function(n,s,r,l){const o=u.personal.find(t=>t.idPersonal===n);return o?o.nombre_completo:""}},{data:"motivo"},{data:"numeroDias"},{data:"fechaInicio"},{data:"fechaFin"}],f=v(!1);v(!1);const d=v([]),y=L({_method:"DELETE"}),w=()=>{f.value=!1},F=n=>{d.value.includes(n)?d.value=d.value.filter(r=>r!==n):d.value.push(n);const s=document.getElementById("eliminarABtn");d.value.length>0?s.removeAttribute("disabled"):s.setAttribute("disabled","")};q(()=>{document.getElementById("vacacionesTablaId").addEventListener("click",n=>{const s=n.target;if(s.classList.contains("vacaciones-checkboxes")){const r=parseInt(s.getAttribute("data-id"));if(u.vacaciones){const l=u.vacaciones.find(o=>o.idVacaciones===r);l?F(l):console.log("No se tiene movimiento")}}})});const T=()=>{const n=j.mixin({buttonsStyling:!0}),s=d.value.map(r=>{const l=u.personal.find(o=>o.idPersonal===r.idPersonal);return`${l?l.nombre_completo:"Desconocido"}`}).join("<br>");n.fire({title:"¿Estas seguro que deseas eliminar las vacaciones del personal seleccionado?",html:`Vacaciones seleccionado:<br>${s}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async r=>{if(r.isConfirmed)try{const o=d.value.map(a=>a.idVacaciones).join(",");await y.post(route("rh.eliminarVacaciones",o)),d.value=[];const t=document.getElementById("eliminarABtn");d.value.length>0?t.removeAttribute("disabled"):t.setAttribute("disabled",""),j.fire({title:"Vacaciones eliminado(s) correctamente",icon:"success"}),window.flash={message:"Vacaciones eliminado(s) correctamente",color:"green"}}catch(l){console.log("Error al eliminar varias vacaciones: "+l),j.fire({title:"Error",text:"Hubo un error al eliminar el movimiento. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(n,s)=>(b(),R(X,{title:"Vacaciones",usuario:u.usuario},{default:C(()=>[e("div",Pe,[s[4]||(s[4]=e("h2",{class:"font-bold text-center text-xl pt-0"},"Vacaciones",-1)),s[5]||(s[5]=e("div",{class:"my-1"},null,-1)),s[6]||(s[6]=e("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1)),B(G),e("div",$e,[e("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:s[0]||(s[0]=r=>f.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},s[1]||(s[1]=[e("i",{class:"fa fa-plus mr-2"},null,-1),p("Registrar Vacaciones ")])),e("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:T},s[2]||(s[2]=[e("i",{class:"fa fa-trash mr-2"},null,-1),p(" Eliminar Vacaciones ")]))]),e("div",Be,[B(m(P),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"vacacionesTablaId",name:"vacacionesTablaId",columns:h,data:c.vacaciones,options:{responsive:!1,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)"},buttons:[i],paging:!1}},{default:C(()=>s[3]||(s[3]=[e("thead",null,[e("tr",{class:"text-sm leading-normal"},[e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Personal Administrativo "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Motivo "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Número de Días "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Fecha de Inicio "),e("th",{class:"py-2 px-4 bg-sky-200 font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Fecha de Fin ")])],-1)])),_:1},8,["data","options"])])]),B(Ne,{show:f.value,"max-width":je,closeable:Ae,onClose:w,title:"Añadir Vacaciones",modal:"modalCreate",personal:u.personal,vacaciones:u.vacaciones},null,8,["show","personal","vacaciones"])]),_:1},8,["usuario"]))}};export{Ye as default};
