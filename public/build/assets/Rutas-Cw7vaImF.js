import{u as D,i as O,r as R,o as v,j,e as E,a as t,g as U,t as k,w as S,d as u,k as I,c as L,l as P,f as x,L as T,D as M,s as Y,b as w}from"./app-CxKqs0Fi.js";import"./buttons.print-BrRPBxib.js";import{S as B}from"./sweetalert2.all-DtmMdzrn.js";import{_ as J}from"./Mensaje-BxEPAEeA.js";import{_ as K}from"./ServicioLayout-EXD9NEfj.js";import{_ as V}from"./Modal-DodXBmJB.js";import{r as W}from"./index-CipgTxR_.js";import{E as Q}from"./jspdf.plugin.autotable-BJqd5KGX.js";import{u as C,w as Z}from"./xlsx-769MyM77.js";/* empty css                                                */const tt={class:"mt-2 bg-white p-4 shadow rounded-lg"},et={class:"border-b border-gray-900/10 pb-12"},at={class:"text-base font-semibold leading-7 text-gray-900"},st=t("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Rellene el campo para registrar una nueva ruta ",-1),ot={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},rt={class:"sm:col-span-1",hidden:""},it=t("label",{for:"idRuta",class:"block text-sm font-medium leading-6 text-gray-900"},"idRuta",-1),nt={class:"mt-2"},lt=["id"],dt={class:"sm:col-span-2"},ut=t("label",{for:"nombreRuta",class:"block text-sm font-medium leading-6 text-gray-900"},"Nombre de la ruta",-1),ct={class:"mt-2"},mt=["id"],gt={key:0,class:"text-red-500 text-xs mt-1"},bt={class:"mt-6 flex items-center justify-end gap-x-6"},pt=["id"],ft=t("i",{class:"fa-solid fa-ban"},null,-1),ht=["disabled"],xt=t("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),yt={__name:"FormularioRuta",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},ruta:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:m}){const g=o,y=m,a=D({idRuta:g.ruta.idRuta,nombreRuta:g.ruta.nombreRuta});O(()=>g.ruta,async e=>{a.idRuta=e.idRuta,a.nombreRuta=e.nombreRuta},{deep:!0});const l=R(""),c=async()=>{y("close"),a.reset()},h=e=>typeof e=="string"&&e.trim()!=="",_=async()=>{l.value=h(a.nombreRuta)?"":"Ingrese el nombre de la ruta",!l.value&&a.post(W("servicio.addRuta"),{onSuccess:()=>{c(),l.value=""}})};return(e,n)=>(v(),j(V,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:c},{default:E(()=>[t("div",tt,[t("form",{onSubmit:U(_,["prevent"])},[t("div",et,[t("h2",at,k(o.title),1),st,t("div",ot,[t("div",rt,[it,t("div",nt,[S(t("input",{type:"number",name:"idRuta","onUpdate:modelValue":n[0]||(n[0]=b=>u(a).idRuta=b),placeholder:"Ingrese id de la ruta",id:"idRuta"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,lt),[[I,u(a).idRuta]])])])]),t("div",dt,[ut,t("div",ct,[S(t("input",{type:"text",name:"nombreRuta",id:"nombreRuta"+o.op,"onUpdate:modelValue":n[1]||(n[1]=b=>u(a).nombreRuta=b),placeholder:"Ingrese el nombre de la ruta",class:"block w-full sm:w-1/2 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,mt),[[I,u(a).nombreRuta]])]),l.value!=""?(v(),L("div",gt,k(l.value),1)):P("",!0)])]),t("div",bt,[t("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:c},[ft,x(" Cancelar")],8,pt),t("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:u(a).processing},[xt,x("Guardar")],8,ht)])],32)])]),_:1},8,["show","max-width","closeable"]))}},_t={class:"mt-2 bg-white p-4 shadow rounded-lg"},Rt={class:"border-b border-gray-900/10 pb-12"},vt={class:"text-base font-semibold leading-7 text-gray-900"},wt=t("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Modifique el campo y guarde los cambios. ",-1),$t={class:"mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},Et={class:"sm:col-span-1",hidden:""},kt=t("label",{for:"idRuta",class:"block text-sm font-medium leading-6 text-gray-900"},"idRuta",-1),St={class:"mt-2"},It=["id"],Tt={class:"sm:col-span-2"},Bt=t("label",{for:"nombreRuta",class:"block text-sm font-medium leading-6 text-gray-900"},"Nombre de la ruta",-1),Ct={class:"mt-2"},Dt=["id"],jt={key:0,class:"text-red-500 text-xs mt-1"},At={class:"mt-6 flex items-center justify-end gap-x-6"},Nt=["id"],Mt=t("i",{class:"fa-solid fa-ban"},null,-1),Ft=["disabled"],zt=t("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1),Ot={__name:"FormularioActualizarRuta",props:{show:{type:Boolean,default:!1,hora:String},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},ruta:{type:Object,default:()=>({})},title:{type:String},modal:{type:String},op:{type:String}},emits:["close"],setup(o,{emit:m}){const g=o,y=m,a=D({_method:"PUT",idRuta:g.ruta.idRuta,nombreRuta:g.ruta.nombreRuta});O(()=>g.ruta,async e=>{a.idRuta=e.idRuta,a.nombreRuta=e.nombreRuta},{deep:!0});const l=R(""),c=async()=>{y("close"),a.reset()},h=e=>typeof e=="string"&&e.trim()!=="",_=async()=>{if(l.value=h(a.nombreRuta)?"":"Ingrese el número de la ruta",!l.value){var e=document.getElementById("idRuta2").value;a.post(W("servicio.actualizarRuta",e),{onSuccess:()=>{c(),l.value=""},onError:n=>{console.error("Error al actualizar la ruta:",n)}})}};return(e,n)=>(v(),j(V,{show:o.show,"max-width":o.maxWidth,closeable:o.closeable,onClose:c},{default:E(()=>[t("div",_t,[t("form",{onSubmit:U(_,["prevent"])},[t("div",Rt,[t("h2",vt,k(o.title),1),wt,t("div",$t,[t("div",Et,[kt,t("div",St,[S(t("input",{type:"number",name:"idRuta","onUpdate:modelValue":n[0]||(n[0]=b=>u(a).idRuta=b),placeholder:"Ingrese id de la ruta",id:"idRuta"+o.op,class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,It),[[I,u(a).idRuta]])])])]),t("div",Tt,[Bt,t("div",Ct,[S(t("input",{type:"text",name:"nombreRuta",id:"nombreRuta"+o.op,"onUpdate:modelValue":n[1]||(n[1]=b=>u(a).nombreRuta=b),placeholder:"Ingrese el nombre de la ruta",class:"block w-full sm:w-1/2 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},null,8,Dt),[[I,u(a).nombreRuta]])]),l.value!=""?(v(),L("div",jt,k(l.value),1)):P("",!0)])]),t("div",At,[t("button",{type:"button",id:"cerrar"+o.op,class:"text-sm font-semibold leading-6 bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-white py-2 px-4 rounded","data-bs.dismiss":"modal",onClick:c},[Mt,x(" Cancelar")],8,Nt),t("button",{type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",disabled:u(a).processing},[zt,x("Guardar")],8,Ft)])],32)])]),_:1},8,["show","max-width","closeable"]))}},Ut={class:"mt-0 bg-white p-4 shadow rounded-lg h-5/6"},Lt=t("h2",{class:"font-bold text-center text-xl pt-0"},"Rutas",-1),Pt=t("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-3"},null,-1),Vt={class:"py-3 flex flex-col md:flex-row md:items-start md:space-x-3 space-y-3 md:space-y-0"},Wt=t("i",{class:"fa fa-plus mr-2"},null,-1),qt=t("i",{class:"fa fa-trash mr-2"},null,-1),Gt=t("thead",null,[t("tr",{class:"text-sm leading-normal"},[t("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}),t("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," ID "),t("th",{class:"py-2 px-4 bg-grey-lightest font-bold uppercase text-sm text-grey-light border-b border-grey-light"}," Ruta ")])],-1),F="xl",z=!0,oe={__name:"Rutas",props:{ruta:{type:Object},usuario:{type:Object}},setup(o){T.use(M),T.use(M);const m=o,g=(r="Documento")=>{const s=new Q("portrait");s.setFontSize(12),s.text(r,14,22);const i=new Date().toLocaleDateString();s.setFontSize(8),s.text(`Fecha: ${i}`,175,22);const p=["ID","Ruta"],f=[];nextTick(()=>{$("#rutasTablaId").DataTable().rows({search:"applied"}).data().each(N=>{f.push([N.idRuta,N.nombreRuta])}),s.autoTable({head:[p],body:f,startY:24}),s.save(`${r}.pdf`)})},y=()=>{nextTick(()=>{const i=$("#rutasTablaId").DataTable().rows({search:"applied"}).data().toArray().map(f=>({ID:f.idRuta,Ruta:f.nombreRuta})),d=C.json_to_sheet(i),p=C.book_new();C.book_append_sheet(p,d,"Rutas Registradas"),Z(p,"Rutas Registradas.xlsx")})},a=[{extend:"copyHtml5",text:'<i class="fa-solid fa-copy"></i> Copiar',className:"bg-cyan-500 hover:bg-cyan-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[0,2]},button:!0},{title:"Rutas registradas",text:'<i class="fa-solid fa-file-excel"></i> Excel',className:"bg-green-600 hover:bg-green-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>y()},{title:"Rutas registradas",text:'<i class="fa-solid fa-file-pdf"></i> PDF',className:"bg-red-500 hover:bg-red-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",action:()=>g(m.title||"Rutas Registradas")},{title:"Rutas registradas",extend:"print",text:'<i class="fa-solid fa-print"></i> Imprimir',className:"bg-blue-500 hover:bg-blue-600 text-white py-1/2 px-3 rounded mb-2 jump-icon",exportOptions:{columns:[1,2]}}],l=[{data:null,render:function(r,s,i,d){return`<input type="checkbox" class="ruta-checkboxes" data-id="${i.idRuta}" ">`}},{data:null,render:function(r,s,i,d){return d.row+1}},{data:"nombreRuta"},{data:null,render:function(r,s,i,d){return`<button class="editar-button" data-id="${i.idRuta}" style="display: flex; justify-content: center;"><i class="fa fa-pencil"></i></button>`}}],c=R(!1),h=R(!1),_=D({_method:"DELETE"}),e=R([]);var n={};const b=r=>{n=r,h.value=!0},q=()=>{c.value=!1},G=()=>{h.value=!1},H=r=>{e.value.includes(r)?e.value=e.value.filter(i=>i!==r):e.value.push(r);const s=document.getElementById("eliminarABtn");e.value.length>0?s.removeAttribute("disabled"):s.setAttribute("disabled","")};Y(()=>{document.getElementById("rutasTablaId").addEventListener("click",r=>{const s=r.target;if(s.classList.contains("ruta-checkboxes")){const i=parseInt(s.getAttribute("data-id"));if(m.ruta){const d=m.ruta.find(p=>p.idRuta===i);d?H(d):console.log("No se tiene ruta")}}}),$("#rutasTablaId").on("click",".editar-button",function(){const r=$(this).data("id"),s=m.ruta.find(i=>i.idRuta===r);b(s)})});const X=()=>{const r=B.mixin({buttonsStyling:!0}),s=e.value.map(i=>i.nombreRuta).join(", ");r.fire({title:"¿Estas seguro que deseas eliminar la(s) ruta(s) seleccionada(s)?",html:`Rutas seleccionadas: ${s}`,icon:"warning",showCancelButton:!0,confirmButtonText:'<i class="fa-solid fa-check"></i> Confirmar',cancelButtonText:'<i class="fa-solid fa-ban"></i> Cancelar'}).then(async i=>{if(i.isConfirmed)try{const p=e.value.map(A=>A.idRuta).join(",");await _.post(route("servicio.eliminarRuta",p)),e.value=[];const f=document.getElementById("eliminarABtn");e.value.length>0?f.removeAttribute("disabled"):f.setAttribute("disabled",""),B.fire({title:"Ruta(s) eliminada(s) correctamente",icon:"success"}),window.flash={message:"Ruta(s) eliminada(s) correctamente",color:"green"}}catch(d){console.log("Error al eliminar varias rutas: "+d),B.fire({title:"Error",text:"Hubo un error al eliminar las rutas. Por favor, inténtalo de nuevo más tarde.",icon:"error"})}})};return(r,s)=>(v(),j(K,{title:"Rutas",usuario:m.usuario},{default:E(()=>[t("div",Ut,[Lt,Pt,w(J),t("div",Vt,[t("button",{class:"bg-green-500 hover:bg-green-500 text-white font-semibold py-2 px-4 rounded",onClick:s[0]||(s[0]=i=>c.value=!0),"data-bs-toggle":"modal","data-bs-target":"#modalCreate"},[Wt,x("Agregar Ruta ")]),t("button",{id:"eliminarABtn",disabled:"",class:"bg-red-500 hover:bg-red-500 text-white font-semibold py-2 px-4 rounded",onClick:X},[qt,x("Borrar Ruta ")])]),t("div",null,[w(u(T),{class:"w-full table-auto text-sm display nowrap stripe compact cell-border order-column",id:"rutasTablaId",name:"rutasTablaId",columns:l,data:o.ruta,options:{responsive:!0,autoWidth:!1,dom:"Bftrip",language:{search:"Buscar",zeroRecords:"No hay registros para mostrar",info:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primero",previous:"Anterior",next:"Siguiente",last:"Ultimo"}},buttons:[a]}},{default:E(()=>[Gt]),_:1},8,["data","options"])])]),w(yt,{show:c.value,"max-width":F,closeable:z,onClose:q,title:"Añadir ruta",op:"1",modal:"modalCreate",ruta:m.ruta},null,8,["show","ruta"]),w(Ot,{show:h.value,"max-width":F,closeable:z,onClose:G,title:"Editar ruta",op:"2",modal:"modalEdit",ruta:u(n)},null,8,["show","ruta"])]),_:1},8,["usuario"]))}};export{oe as default};
