import{_ as K,a as L,b as G,c as Y,d as M,e as H,f as q,g as I}from"./ReportesUltimasCorridas-Z2rAW3qw.js";import{_ as J}from"./ServicioLayout-DTe5CgIe.js";import{r as U,J as Q,o as f,h as g,y as v,b as s,t as S,j as D,z as E,u as C,K as W,F as y,i as X,n as k,k as T,G as z,a as Z,w as ee,d as p}from"./app-B1jIQaT9.js";import{S as $}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as b,w as P}from"./xlsx-DjuO7_Ju.js";import{E as B}from"./jspdf.plugin.autotable-DUFfiHYz.js";/* empty css                                                               */const oe={class:"text-lg font-bold"},ae={class:"flex flex-wrap gap-4 mb-3"},te={class:"flex flex-wrap space-x-3 mb-2"},re=["onUpdate:modelValue"],ne=["value"],se={class:"flex flex-wrap space-x-3"},de=["onClick"],F=2024,ie={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(N){const e=U([]),w=Q({unidad:null,operador:null}),m=async a=>{const t=route("reporte.opSinTrabajar",{semana:a});console.log("URL de la API:",t);try{const o=await z.get(t);e.value=Object.values(o.data),console.log("Entradas.value",e.value),console.log("response.data",o.data)}catch(o){console.error("Error al obtener los datos:",o.response?o.response.data:o.message),$.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},O=async(a,t,o,r)=>{if(console.log("Semana seleccionada:",n),!n){$.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await m(n),a.titulo==="Operadores Sin Trabajar"&&(t==="pdf"?j(a.titulo,n):t==="excel"&&A(a.titulo,n))}catch{$.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},j=(a,t)=>{const o=new B("portrait");o.setFontSize(12),o.text(`Reporte de ${a} - Semana ${t}`,14,20),o.setFontSize(10),o.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const r=[{header:"Nombre del operador",dataKey:"nombre"}],c=e.value.map(h=>({nombre:h.nombre_completo||"N/A"}));o.autoTable({columns:r,body:c,startY:24,styles:{fontSize:10}});const _=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});o.setFontSize(10),o.text(`Fecha de creación: ${_}`,14,o.internal.pageSize.height-10);const x=`${a}-Semana-${t}.pdf`;o.save(x)},A=(a,t)=>{const o=`${a}-Semana-${t}.xlsx`,r=[["Nombre del Operador"]];e.value.forEach(x=>{const h=x.nombre_completo||"N/A";r.push([h])});const c=b.book_new(),_=b.aoa_to_sheet(r);b.book_append_sheet(c,_,"Operadores_Sin_Trabajar"),P(c,o)},u=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],d=Array.from({length:52},(a,t)=>t+1),i=new Date().getFullYear();Array.from({length:i-F+1},(a,t)=>F+t);let n=1;const l=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(a,t)=>(f(),g(y,null,v(l,o=>s("div",{key:o.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[s("h3",oe,S(o.titulo),1),t[3]||(t[3]=s("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),s("div",ae,[s("div",te,[t[2]||(t[2]=s("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1)),D(s("select",{"onUpdate:modelValue":r=>o.periodoSeleccionado=r,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},t[1]||(t[1]=[s("option",{value:"semana"},"Semanal",-1)]),8,re),[[E,o.periodoSeleccionado]]),o.periodoSeleccionado==="semana"?D((f(),g("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=r=>W(n)?n.value=r:n=r),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(f(!0),g(y,null,v(C(d),(r,c)=>(f(),g("option",{key:c,value:r},"Semana "+S(r),9,ne))),128))],512)),[[E,C(n)]]):X("",!0)])]),s("div",se,[(f(),g(y,null,v(u,r=>s("button",{key:r.tipo,class:k(r.clase),onClick:c=>O(o,r.tipo,w.operador,{tipo:o.periodoSeleccionado,valor:o.periodoSeleccionado==="semana"?C(n):""})},[s("i",{class:k(r.icono+" mr-2 jump-icon")},null,2),T(" "+S(r.texto),1)],10,de)),64))])])),64))}},le={class:"text-lg font-bold"},ce={class:"flex flex-wrap space-x-3"},ue=["onClick"],pe={__name:"ReportesMultasDominicales",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})}},setup(N){const e=U([]),w=[{titulo:"Multas Dominicales"}],m=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],O=async(u,d)=>{console.log("Estoy en generar Archivo:");try{const i=await z.get(route("reporte.multasDominicales"));e.value=i.data,console.log("Datos obtenidos de la consulta:",e.value),d==="pdf"?j(u.titulo):d==="excel"&&A(u.titulo)}catch(i){console.error(i),$.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},j=u=>{const d=new B("landscape");d.setFontSize(12),d.text(`Reporte de ${u}`,14,20);const i=e.value.map(l=>{const a=l.ruta?l.ruta.nombreRuta:"N/A",t=l.created_at?new Date(l.created_at).toLocaleDateString():"N/A",o=l.numeroUnidad||"N/A",r=l.directivo?`${l.directivo.nombre_completo}`:"N/A",c=l.operador?`${l.operador.nombre_completo}`:"N/A";return[a,t,o,r,c]}),n=[["Ruta","Fecha","Numero Unidad","Socio/Prestador","Operador"]];d.autoTable({head:n,body:i,startY:24}),d.save(`${u}.pdf`)},A=u=>{const d=`${u}.xlsx`,i=[["Ruta","Fecha","Numero Unidad","Socio/Prestador","Hora Corte","Causa","Hora Regreso","Operador"]];e.value.forEach(a=>{var R;const t=a.ruta?a.ruta.nombreRuta:"N/A",o=a.created_at?new Date(a.created_at).toLocaleDateString():"N/A",r=((R=a.unidad)==null?void 0:R.numeroUnidad)||"N/A",c=a.directivo?`${a.directivo.nombre_completo}`:"N/A",_=a.horaCorte?a.horaCorte.substring(0,5):"N/A",x=a.causa||"N/A",h=a.horaRegreso?a.horaRegreso.substring(0,5):"Sin Regreso",V=a.operador?`${a.operador.nombre_completo}`:"N/A";i.push([t,o,r,c,_,x,h,V])});const n=b.book_new(),l=b.aoa_to_sheet(i);b.book_append_sheet(n,l,"Reporte_Multas"),P(n,d)};return(u,d)=>(f(),g(y,null,v(w,i=>s("div",{key:i.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[s("h3",le,S(i.titulo),1),d[0]||(d[0]=s("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),s("div",ce,[(f(),g(y,null,v(m,n=>s("button",{key:n.tipo,class:k(n.clase),onClick:l=>O(i,n.tipo)},[s("i",{class:k(n.icono+" mr-2 jump-icon")},null,2),T(" "+S(n.texto),1)],10,ue)),64))])])),64))}},me={class:"mt-1 bg-white p-4 shadow rounded-lg h-5/6"},Se={__name:"Reportes",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},tipoUltimaCorrida:{type:Object,default:()=>({})},entrada:{type:Object,default:()=>({})},corte:{type:Object,default:()=>({})},ultimaCorrida:{type:Object,default:()=>({})},castigo:{type:Object,default:()=>({})}},setup(N){const e=N;return(w,m)=>(f(),Z(J,{title:"Reportes",usuario:e.usuario},{default:ee(()=>[s("div",me,[m[0]||(m[0]=s("h2",{class:"font-bold text-center text-xl pt-0 mb-2"},"Reportes",-1)),m[1]||(m[1]=s("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-2"},null,-1)),p(K,{unidad:e.unidad,operador:e.operador,entrada:e.entrada},null,8,["unidad","operador","entrada"]),p(L,{unidad:e.unidad,operador:e.operador,entrada:e.entrada},null,8,["unidad","operador","entrada"]),p(G,{unidad:e.unidad,operador:e.operador,corte:e.corte},null,8,["unidad","operador","corte"]),p(Y,{unidad:e.unidad,operador:e.operador,corte:e.corte},null,8,["unidad","operador","corte"]),p(M,{unidad:e.unidad,operador:e.operador,corte:e.corte},null,8,["unidad","operador","corte"]),p(H,{unidad:e.unidad,operador:e.operador,tipoUltimaCorrida:e.tipoUltimaCorrida,ultimaCorrida:e.ultimaCorrida},null,8,["unidad","operador","tipoUltimaCorrida","ultimaCorrida"]),p(q,{unidad:e.unidad,operador:e.operador,castigo:e.castigo},null,8,["unidad","operador","castigo"]),p(I,{unidad:e.unidad,operador:e.operador},null,8,["unidad","operador"]),p(ie,{unidad:e.unidad,operador:e.operador},null,8,["unidad","operador"]),p(pe,{unidad:e.unidad,entrada:e.entrada,corte:e.corte},null,8,["unidad","entrada","corte"])])]),_:1},8,["usuario"]))}};export{Se as default};
