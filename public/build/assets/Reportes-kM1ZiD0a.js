import{_ as U,a as z,b as B,c as D,d as R,e as V,f as K,g as P}from"./ReportesUltimasCorridas-DxPMjgSp.js";import{_ as L}from"./ServicioLayout-UzWqJf9A.js";import{r as Y,J as G,o as c,c as u,m as g,a as t,t as b,w,p as $,d as x,K as q,F as _,l as I,n as k,f as J,G as M,j as H,e as Q,b as d}from"./app-Ulf1_P01.js";import{S as y}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{u as h,w as W}from"./xlsx-DjuO7_Ju.js";import{E as X}from"./jspdf.plugin.autotable-CqtI2_So.js";/* empty css                                                               */const Z={class:"text-lg font-bold"},ee={class:"flex flex-wrap gap-4 mb-3"},oe={class:"flex flex-wrap space-x-3 mb-2"},ae=["onUpdate:modelValue"],re=["value"],te={class:"flex flex-wrap space-x-3"},ne=["onClick"],j=2024,se={__name:"ReporteOperadoresSinTrabajar",props:{message:{String,default:""},color:{String,default:""},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})}},setup(S){const o=Y([]),v=G({unidad:null,operador:null}),l=async n=>{const a=route("reporte.opSinTrabajar",{semana:n});console.log("URL de la API:",a);try{const e=await M.get(a);o.value=Object.values(e.data),console.log("Entradas.value",o.value),console.log("response.data",e.data)}catch(e){console.error("Error al obtener los datos:",e.response?e.response.data:e.message),y.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},O=async(n,a,e,r)=>{if(console.log("Semana seleccionada:",s),!s){y.fire({title:"Error",text:"Por favor seleccione una semana para generar el archivo.",icon:"error",confirmButtonText:"OK"});return}try{await l(s),n.titulo==="Operadores Sin Trabajar"&&(a==="pdf"?E(n.titulo,s):a==="excel"&&C(n.titulo,s))}catch{y.fire({title:"Error",text:"No se pudieron obtener los datos",icon:"error",confirmButtonText:"OK"})}},E=(n,a)=>{const e=new X("portrait");e.setFontSize(12),e.text(`Reporte de ${n} - Semana ${a}`,14,20),e.setFontSize(10),e.text("Los operadores que aparecen en el listado no trabajaron ni al menos 1 día durante la semana seleccionada.",14,30);const r=[{header:"Nombre del operador",dataKey:"nombre"}],i=o.value.map(f=>({nombre:f.nombre_completo||"N/A"}));e.autoTable({columns:r,body:i,startY:24,styles:{fontSize:10}});const p=new Date().toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"});e.setFontSize(10),e.text(`Fecha de creación: ${p}`,14,e.internal.pageSize.height-10);const m=`${n}-Semana-${a}.pdf`;e.save(m)},C=(n,a)=>{const e=`${n}-Semana-${a}.xlsx`,r=[["Nombre del Operador"]];o.value.forEach(m=>{const f=m.nombre_completo||"N/A";r.push([f])});const i=h.book_new(),p=h.aoa_to_sheet(r);h.book_append_sheet(i,p,"Operadores_Sin_Trabajar"),W(i,e)},F=[{tipo:"pdf",texto:"Generar PDF",clase:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-pdf"},{tipo:"excel",texto:"Generar Excel",clase:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded",icono:"fa-solid fa-file-excel"}],N=Array.from({length:52},(n,a)=>a+1),T=new Date().getFullYear();Array.from({length:T-j+1},(n,a)=>j+a);let s=1;const A=[{titulo:"Operadores Sin Trabajar",periodo:"semana",periodoSeleccionado:"semana"}];return(n,a)=>(c(),u(_,null,g(A,e=>t("div",{key:e.titulo,class:"mb-4 bg-zinc-100 rounded-lg p-4"},[t("h3",Z,b(e.titulo),1),a[3]||(a[3]=t("div",{class:"bg-gradient-to-r from-cyan-500 to-cyan-500 h-px mb-2"},null,-1)),t("div",ee,[t("div",oe,[a[2]||(a[2]=t("h2",{class:"font-semibold text-l pt-0"},"Periodo: ",-1)),w(t("select",{"onUpdate:modelValue":r=>e.periodoSeleccionado=r,class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},a[1]||(a[1]=[t("option",{value:"semana"},"Semanal",-1)]),8,ae),[[$,e.periodoSeleccionado]]),e.periodoSeleccionado==="semana"?w((c(),u("select",{key:0,"onUpdate:modelValue":a[0]||(a[0]=r=>q(s)?s.value=r:s=r),class:"block rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"},[(c(!0),u(_,null,g(x(N),(r,i)=>(c(),u("option",{key:i,value:r},"Semana "+b(r),9,re))),128))],512)),[[$,x(s)]]):I("",!0)])]),t("div",te,[(c(),u(_,null,g(F,r=>t("button",{key:r.tipo,class:k(r.clase),onClick:i=>O(e,r.tipo,v.operador,{tipo:e.periodoSeleccionado,valor:e.periodoSeleccionado==="semana"?x(s):""})},[t("i",{class:k(r.icono+" mr-2 jump-icon")},null,2),J(" "+b(r.texto),1)],10,ne)),64))])])),64))}},de={class:"mt-1 bg-white p-4 shadow rounded-lg h-5/6"},ge={__name:"Reportes",props:{message:{String,default:""},color:{String,default:""},usuario:{type:Object},unidad:{type:Object,default:()=>({})},operador:{type:Object,default:()=>({})},tipoUltimaCorrida:{type:Object,default:()=>({})}},setup(S){const o=S;return(v,l)=>(c(),H(L,{title:"Reportes",usuario:o.usuario},{default:Q(()=>[t("div",de,[l[0]||(l[0]=t("h2",{class:"font-bold text-center text-xl pt-0 mb-2"},"Reportes",-1)),l[1]||(l[1]=t("div",{class:"bg-gradient-to-r from-cyan-300 to-cyan-500 h-px mb-2"},null,-1)),d(U,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(z,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(B,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(D,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(R,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(V,{unidad:o.unidad,operador:o.operador,tipoUltimaCorrida:o.tipoUltimaCorrida},null,8,["unidad","operador","tipoUltimaCorrida"]),d(K,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(P,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"]),d(se,{unidad:o.unidad,operador:o.operador},null,8,["unidad","operador"])])]),_:1},8,["usuario"]))}};export{ge as default};
